{
  "hash": "16d2ca5e5252a8b7303c40a827dd93f4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"03.2_clustering\"\nformat:\n  html:\n    theme: Default\n    toc: true\n    code-fold: true\n    self-contained: true\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# scRNA-seq\nlibrary(\"SingleCellExperiment\")\nlibrary(\"Seurat\")\n\n# Clustering trees\nlibrary(\"clustree\")\n\n# Plotting\nlibrary(\"viridis\")\nlibrary(\"ggforce\")\nlibrary(\"cowplot\")\nlibrary(ggrepel)\nlibrary(patchwork)\n\n# Presentation\nlibrary(\"knitr\")\n\n# Tidyverse\nlibrary(\"tidyverse\")\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nproj_dir <- \"/Users/nami/Desktop/sterile_inflammation/\"\nplots_dir <- \"/Users/nami/Desktop/sterile_inflammation/output/plots/03.2_clustering/\"\nsobj_dir <- \"/Users/nami/Desktop/sterile_inflammation/output/processed/\"\nout_data_dir <- \"/Users/nami/Desktop/sterile_inflammation/output/data/03.2_clustering/\"\n\nsource(paste0(proj_dir,\"/functions/universal.R\"))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Define sample names\nsample_names <- c(\"PVM_0h\", \"PVEU_0h\", \"PVM_4h\", \"PVEU_4h\", \"PVM_7h\", \"PVEU_7h\")\n\nsample_colors <- c(\n  \"PVM_0h\"  = \"#EE9A49\",  \n  \"PVM_4h\"  = \"#CD853F\", \n  \"PVM_7h\" = \"#8B5A2B\",  \n  \"PVEU_0h\"  = \"#7EC0EE\",\n  \"PVEU_4h\" = \"#6CA6CD\", \n  \"PVEU_7h\" = \"#4A708B\"\n)\n```\n:::\n\n\n\n# Introduction\n\nAfter talking to Shweta and Rohit once I showed them the results from the last script (03_clustering), it was difficult to say which methods performs clustering better. To get a better idea of what each cluster is at a cell type level, I did a rough cell type annotation ans subsetted the PVM compartment for both methods. In order to streamline things, I kept the resolution for both SCTransform and Seurat VST full objects as 0.2.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nload(file=paste0(proj_dir,\"output/processed/03_SI_seurat_sct.Robj\"))\nload(paste0(proj_dir,\"output/processed/03_SI_seurat_vst.Robj\"))\nseurat_vst <- seurat\nrm(seurat)\n\nres <- 0.2\nIdents(seurat_sct) <- paste0(\"SCT_snn_res.\", res)\nseurat_sct$seurat_clusters <- seurat_sct[[paste0(\"SCT_snn_res.\", res)]]\nIdents(seurat_vst) <- paste0(\"RNA_snn_res.\", res)\nseurat_vst$seurat_clusters <- seurat_vst[[paste0(\"RNA_snn_res.\", res)]]\n```\n:::\n\n\n\n# Compare UMAPs at 0.2 res\n\nThe following plots show what the UMAPs looks like split by seurat clusters and by sample_timepoint.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- DimPlot(seurat_sct, label = TRUE) + NoAxes() + NoLegend() \np2 <- DimPlot(seurat_sct, group.by = \"orig.ident\", \n              cols = sample_colors) +\n  ggtitle(\"SCT\") + NoAxes() \np <- add_mini_axis(p1) + add_mini_axis(p2)\np \n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/umap_sct-1.png){fig-align='center' width=90%}\n:::\n\n```{.r .cell-code}\np3 <- DimPlot(seurat_vst, label = TRUE) + NoAxes() + NoLegend()\np4 <- DimPlot(seurat_vst, group.by = \"orig.ident\", cols = sample_colors) +\n  ggtitle(\"VST\") + NoAxes()\np <- add_mini_axis(p3) + add_mini_axis(p4)\np\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/umap_sct-2.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n# Compare marker genes at 0.2 res\n\nThe marker genes for both objects are attached.\n\nSide note about finding markers and any downstream analysis using SCTransform:\n\nThere was some confusion regarding performing DE analysis after SCTransform. In this context, I found this (https://github.com/satijalab/seurat/issues/2180 and https://github.com/satijalab/seurat/issues/2115):\n\n\"The scale.data (in SCTransform slot) is the pearson residuals that come out of regularized NB regression. The counts and data slot transforms these values back into integer values (stored in counts), and then performs a log-transformation (stored in data).\n\nSCTransform (by default) only stores pearson residuals (scale.data) for 3,000 variable features, to save memory. When possible, we try to perform operations directly on the Pearson residuals themselves. However, these values are not sparse (contain exclusively non-zero elements), so they take a lot of memory to store, and as a result we don't compute them for all genes by default. Unless you change the defaults in SCTransform, performing DE on the scale.data slot would only test differences in variable genes. We also find that pearson residuals are challenging to visualize/interpret on either Feature or Violin plots, and therefore find the data slot in the SCT assay quite useful for this.\n\nSo performing DE on the scale.data slot of this assay means you are only testing 3,000 genes. Performing DE on the RNA assay will test all genes.\"\n\n**Therefore, I have changed the default assay to RNA, and normalized and scaled the data for markers analysis of the SCTransform object in this document.**\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nDefaultAssay(seurat_sct) <- \"RNA\" \nseurat_sct <- NormalizeData(seurat_sct)\nseurat_sct <- ScaleData(seurat_sct)\ndegs_sct <- FindAllMarkers(seurat_sct, only.pos = TRUE, \n                           assay = \"RNA\",\n                           min.pct = 0.25, logfc.threshold = 0.1)\n\n# Extract top 20 genes for each cluster\ntop_genes <- degs_sct %>%\n  group_by(cluster) %>%\n  arrange(desc(avg_log2FC)) %>%\n  slice_head(n = 20)\n\n# Save to CSV file\nwrite.csv(top_genes, paste0(out_data_dir,tag,\"_markers_sct_res0.2.csv\"), \n          row.names = FALSE)\n\n#VST\ndegs_vst <- FindAllMarkers(seurat_vst, only.pos = TRUE, \n                           assay = \"RNA\",\n                           min.pct = 0.25, logfc.threshold = 0.1)\n\n# Extract top 20 genes for each cluster\ntop_genes <- degs_vst %>%\n  group_by(cluster) %>%\n  arrange(desc(avg_log2FC)) %>%\n  slice_head(n = 20)\n\n# Save to CSV file\nwrite.csv(top_genes, paste0(out_data_dir,tag,\"_markers_vst_res0.2.csv\"), \n          row.names = FALSE)\nsave(seurat_sct, file=\"./output/processed/03.2_SI_seurat_sct.Robj\")\n```\n:::\n\n\n\n## SCT\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(DT)\ntop_genes_sct <- read.csv(paste0(out_data_dir,tag,\"_markers_sct_res0.2.csv\"))\n\ndatatable(\n  top_genes_sct,\n  options = list(pageLength = 10, lengthMenu = c(10, 25, 50, 100)),\n  rownames = TRUE\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-60ae7e5e9f14ce2fe7d4\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-60ae7e5e9f14ce2fe7d4\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\",\"194\",\"195\",\"196\",\"197\",\"198\",\"199\",\"200\",\"201\",\"202\",\"203\",\"204\",\"205\",\"206\",\"207\",\"208\",\"209\",\"210\",\"211\",\"212\",\"213\",\"214\",\"215\",\"216\",\"217\",\"218\",\"219\",\"220\",\"221\",\"222\",\"223\",\"224\",\"225\",\"226\",\"227\",\"228\",\"229\",\"230\",\"231\",\"232\",\"233\",\"234\",\"235\",\"236\",\"237\",\"238\",\"239\",\"240\",\"241\",\"242\",\"243\",\"244\",\"245\",\"246\",\"247\",\"248\",\"249\",\"250\",\"251\",\"252\",\"253\",\"254\",\"255\",\"256\",\"257\",\"258\",\"259\",\"260\",\"261\",\"262\",\"263\",\"264\",\"265\",\"266\",\"267\",\"268\",\"269\",\"270\",\"271\",\"272\",\"273\",\"274\",\"275\",\"276\",\"277\",\"278\",\"279\",\"280\"],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.16505795652269e-189,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5.69968008972295e-249,1.1416329593136e-278,2.45708872057578e-216,2.53303571365354e-211,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.11121181362573e-255,0,0,0,9.13495756800774e-267,6.01508367176435e-256,0,0,1.4964581717506e-266,0,7.71656808816363e-254,3.91045518860781e-181,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.27226680304887e-298,0,0,0,1.7668986603206e-304,0,0,2.99217240922283e-280,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[3.34530900401194,3.31742448815683,3.20916694344801,3.15832076992546,3.14959842410229,3.07363592116435,3.04320968522044,3.03933766592487,2.8839663077704,2.85255209400396,2.8220662039047,2.74002897883206,2.72681898885879,2.72361980453912,2.72047302258323,2.56187737107202,2.55209842250066,2.53718556259742,2.49662484509935,2.49106196029516,4.57865859389576,4.33453347730019,4.20449143311715,4.03710390212994,3.96556145552225,3.833791783144,3.80255931350567,3.71872581658659,3.55755529008955,3.50973944839407,3.35401360086501,3.30625944546019,3.26332038266336,3.25414840461912,3.21604250480519,3.17649695958414,3.14719504046292,3.14673093796453,3.10172504580945,3.06738080294325,7.10111720244107,7.03734773359963,6.97219445538991,6.88182535165495,6.80889311791353,6.59172561576938,6.56469839008281,6.53004439365085,6.17592403966444,5.65883184687434,5.62374045032303,5.60072404389553,5.5153755151059,5.42901738828126,5.35998580946489,5.3370566365543,5.33312048229981,5.29020496649984,5.00324073931772,4.81131118574077,9.61432426224747,9.568857823651429,9.48400300142397,9.46223890822391,9.39296508998024,9.32935166268863,9.308283001318889,9.221900161020169,9.156570030211171,9.14769549316008,8.555031466671601,8.421579847572909,8.276990674091779,7.51026584331663,7.28591274127943,6.92490946160749,6.68957258095101,6.68483026214855,6.63725934286501,6.51514619559447,3.88158437190805,3.80989090674864,3.75935837382699,3.67669576680203,3.64770938395597,3.62658425859548,3.54220401636651,3.49690171487053,3.44841088615425,3.35931759434856,3.35111786442322,3.34497966547545,3.32426186236941,3.32257664826208,3.25550309789895,3.20491882170651,3.19472646071254,3.16204575298374,3.15043961303147,3.10461067172583,4.12248424536894,3.42563905751156,3.05193792675833,2.99996616478402,2.99202535251209,2.70424971610363,2.68956930210674,2.64821844465934,2.54621934496979,2.40844433311854,2.40811248542839,2.27015442948962,2.26769327552541,2.14402366233601,2.12718803400734,2.09615765755825,2.06788149109484,2.03603044116809,2.01719821669288,1.98685104404413,7.67351789434841,7.0206812667512,6.83964397249242,6.56833956848106,6.29148173002658,6.2846694435795,6.1386917228571,5.58186813427652,5.55965934284911,5.48654458183284,5.47420056873366,5.45162043620426,5.35556966671493,5.33960509079288,5.26697521214392,5.2252095229562,5.12302744646885,5.09812806226223,5.08534750123335,5.03193747578148,7.9793435055203,7.85326332944794,7.74460784583738,7.71648561438855,7.70743259794194,7.22050122786701,6.91430919521413,6.78957049306866,6.69691864210568,6.6468812424587,6.54607787388762,6.40737622755435,6.38776269017059,6.34386529004702,6.29530314915901,6.27281784834192,6.00258391837241,5.98420514277613,5.9791501330192,5.94261811613763,4.63003112233646,4.42240525523986,4.37094361850663,4.37081935241933,4.36992874133955,4.24366954700513,4.07154890408183,4.06465080455072,4.05070845547326,4.04772736991054,4.04453833482381,4.0332978076311,4.00614548759499,3.98915026797671,3.98507101580968,3.97523788902226,3.94993234167068,3.94923712827759,3.93229964326307,3.90590655242705,6.05420921540484,3.18163375121491,2.7600679763079,2.61910826666402,2.46291440798322,2.28541663711932,2.11550800778945,2.09342854028529,1.97779731143979,1.95990567303121,1.9446328526033,1.90643170954206,1.87499207968269,1.83217542265779,1.78892611863433,1.66918059869854,1.66116344791998,1.61111232537627,1.56871843031849,1.55992136912217,10.2880068318244,10.0416837086577,10.0282178194778,9.56555329978336,9.51989656330441,9.219696163816311,9.111291760231071,8.95607596586764,8.832129378239109,8.82434632158586,8.80206277875803,8.377980712364399,8.260915185134721,8.21488590403219,8.19876378429195,8.174024969366689,8.088265119225319,8.039798050997829,7.69924055548084,7.11799248093783,5.85712972364292,5.67589389793431,5.65559022766496,5.61820413272334,5.59874090502076,5.52932162786404,5.51565091496636,5.45423586755911,5.40109619140415,5.34784979162956,5.34402599488936,5.32584756664589,5.12826983026142,5.10732725969764,5.0727787091962,5.05163264724056,5.04697298370205,4.99363890690628,4.93164525810622,4.89934981331366,10.0394427709877,9.641905470767901,9.55040951493814,9.52812180069062,9.4691627273737,9.29137824407902,9.26492279325168,9.16972473529797,8.986717296033371,8.937702110967409,8.729013702348389,8.675542756971,8.668224051807529,8.373879519939139,8.289782241098569,8.15745072047809,7.90773091473543,7.86604815851956,7.82202102656547,7.77670333605573,9.051841921371469,8.623587351824909,8.303115692245109,8.12935418684757,8.10170820406457,7.31662321919708,7.18787553113936,7.1011051044108,6.99040412322463,6.96281653261555,6.62362601456001,6.45012899944996,6.40894539993724,6.28722752411532,6.03490587123297,5.94093921609694,5.88395125130255,5.76855392664719,5.69738046856543,5.64375957491021],[0.977,0.952,0.259,0.499,0.987,0.983,0.968,0.662,0.968,0.901,0.987,0.623,0.854,0.434,0.842,0.85,0.296,0.872,0.5679999999999999,0.29,0.419,0.571,0.443,0.266,0.608,0.456,0.306,0.8,0.274,0.337,0.6879999999999999,0.437,0.445,0.482,0.302,0.326,0.979,0.759,0.8169999999999999,0.741,0.911,0.542,0.735,0.9370000000000001,0.997,0.771,0.849,0.371,0.979,0.908,0.5669999999999999,0.486,0.8090000000000001,0.336,0.379,0.717,0.368,0.359,0.594,0.617,0.61,0.971,0.78,0.3,0.74,0.337,0.958,0.354,0.552,0.272,0.637,0.753,0.779,0.383,0.303,0.712,0.497,0.775,0.9330000000000001,0.634,0.877,0.729,0.909,0.596,0.67,0.944,0.453,0.467,0.394,0.884,0.283,0.762,0.627,0.907,0.745,0.9,0.772,0.925,0.489,0.31,0.292,0.342,0.456,0.405,0.264,0.307,0.403,0.553,0.453,0.299,0.468,0.374,0.251,0.882,0.514,0.398,0.384,0.436,0.299,0.379,0.292,0.623,0.602,0.766,0.289,0.555,0.26,0.27,0.3,0.768,0.456,0.539,0.263,0.323,0.352,0.516,0.79,0.653,0.857,0.539,0.268,0.437,0.518,0.256,0.6860000000000001,0.306,0.418,0.357,0.364,0.335,0.449,0.372,0.31,0.303,0.289,0.287,0.31,0.265,0.376,0.797,0.416,0.273,0.749,0.35,0.84,0.985,0.544,0.569,0.595,0.311,0.338,0.8169999999999999,0.703,0.978,0.544,0.619,0.843,0.823,0.6889999999999999,0.469,0.999,0.608,0.258,0.985,0.698,0.473,0.267,0.481,0.515,0.744,0.653,0.374,0.859,0.534,0.572,0.577,0.434,0.25,0.846,0.885,0.327,0.705,0.644,0.486,0.369,0.441,0.327,0.758,0.5659999999999999,0.296,0.602,0.321,0.458,0.404,0.515,0.293,0.804,0.418,0.27,0.316,0.501,0.737,0.543,0.261,0.381,0.443,0.574,0.5570000000000001,0.473,0.414,0.283,0.322,0.277,0.442,0.525,0.861,0.28,0.443,0.447,0.313,0.318,0.838,0.834,0.85,0.433,0.852,0.277,0.61,0.515,0.251,0.366,0.637,0.9340000000000001,0.285,0.316,0.281,0.374,0.431,0.384,0.357,0.838,0.986,0.611,0.377,0.464,0.769,0.304,0.358,0.296,0.314,0.64,0.476,0.429,0.87,0.48,0.796,0.998,0.905,0.368,0.5649999999999999],[0.391,0.303,0.041,0.104,0.626,0.441,0.43,0.178,0.445,0.264,0.6840000000000001,0.183,0.241,0.064,0.422,0.262,0.049,0.284,0.122,0.067,0.021,0.03,0.022,0.016,0.049,0.033,0.027,0.154,0.023,0.039,0.117,0.057,0.099,0.062,0.029,0.051,0.516,0.188,0.194,0.194,0.014,0.004,0.007,0.018,0.032,0.008999999999999999,0.016,0.004,0.043,0.018,0.01,0.008,0.021,0.008,0.005,0.01,0.007,0.007,0.011,0.014,0.008,0.127,0.021,0.003,0.006,0.003,0.118,0.002,0.004,0.004,0.004,0.008999999999999999,0.021,0.005,0.007,0.027,0.016,0.041,0.052,0.026,0.328,0.227,0.395,0.232,0.381,0.481,0.131,0.105,0.121,0.395,0.11,0.274,0.243,0.485,0.333,0.516,0.338,0.481,0.229,0.091,0.025,0.035,0.079,0.119,0.041,0.036,0.064,0.08400000000000001,0.08599999999999999,0.063,0.08599999999999999,0.08799999999999999,0.039,0.479,0.151,0.082,0.13,0.15,0.09,0.145,0.003,0.013,0.025,0.03,0.007,0.02,0.007,0.008999999999999999,0.008999999999999999,0.044,0.033,0.023,0.008,0.01,0.013,0.025,0.055,0.089,0.063,0.035,0.002,0.006,0.006,0.002,0.01,0.004,0.006,0.005,0.007,0.008,0.011,0.008,0.005,0.007,0.007,0.006,0.007,0.005,0.008999999999999999,0.035,0.045,0.028,0.118,0.04,0.14,0.284,0.076,0.101,0.093,0.042,0.038,0.144,0.116,0.327,0.082,0.08599999999999999,0.176,0.154,0.149,0.07199999999999999,0.251,0.08,0.029,0.48,0.218,0.117,0.053,0.118,0.125,0.246,0.268,0.097,0.398,0.159,0.205,0.166,0.125,0.06,0.406,0.34,0.001,0.002,0.001,0.002,0.001,0.002,0.001,0.003,0.004,0.001,0.003,0.002,0.004,0.003,0.003,0.002,0.018,0.003,0.003,0.003,0.039,0.061,0.047,0.016,0.03,0.029,0.048,0.055,0.054,0.041,0.022,0.023,0.024,0.058,0.059,0.14,0.024,0.054,0.048,0.034,0.001,0.01,0.082,0.09,0.002,0.054,0.001,0.011,0.004,0.001,0.003,0.007,0.044,0.003,0.002,0.002,0.004,0.005,0.005,0.003,0.006,0.029,0.003,0.005,0.001,0.008999999999999999,0.002,0.003,0.002,0.004,0.008999999999999999,0.004,0.005,0.165,0.007,0.016,0.112,0.038,0.011,0.011],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4.46759709328456e-185,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.17612898651433e-244,2.35575961154362e-274,5.07020257490812e-212,5.22691919512409e-207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.29298557741669e-251,0,0,0,1.8849984941584e-262,1.24121251566857e-251,0,0,3.08794143740736e-262,0,1.59231382499257e-249,8.069224281692211e-177,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.62532254809134e-294,0,0,0,3.64599538557156e-300,0,0,6.17434776643132e-276,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13],[\"Ccl4\",\"Mt2\",\"Calhm6\",\"Timp1\",\"Mt1\",\"Sdc4\",\"Ccl7\",\"Cd209a\",\"Ccl9\",\"Ccl3\",\"Wfdc17\",\"Ccl5\",\"Ifit1\",\"Lipg\",\"Ccl24\",\"Il1rn\",\"4930430E12Rik\",\"Rsad2\",\"Ifi206\",\"Ch25h\",\"Tmem37\",\"Chp2\",\"Gpr34\",\"Tslp\",\"Hpgd\",\"Selenbp1\",\"Tmem141\",\"Ltc4s\",\"Rac3\",\"Cd209g\",\"Rnase4\",\"Ang\",\"Cd209f\",\"Tnfsf13\",\"Hfe\",\"Pla2g2d\",\"Selenop\",\"Lyve1\",\"Fcgrt\",\"Fxyd2\",\"Iglc2\",\"Iglc1\",\"Mzb1\",\"Ly6d\",\"Cd79a\",\"Iglc3\",\"Igkc\",\"Zbtb32\",\"Cd79b\",\"Ms4a1\",\"Fcmr\",\"Fcrla\",\"H2-DMb2\",\"Fcrl5\",\"Spib\",\"Cd19\",\"Tnfrsf13c\",\"H2-Oa\",\"Gm30211\",\"Scd1\",\"G0s2\",\"S100a9\",\"Retnlg\",\"Stfa2l1\",\"Il1f9\",\"Asprv1\",\"S100a8\",\"Mrgpra2b\",\"Chil1\",\"Cstdc4\",\"Cxcr2\",\"Il1r2\",\"Wfdc21\",\"H2-Q10\",\"Mmp8\",\"Trem1\",\"Trem3\",\"Pglyrp1\",\"Slc7a11\",\"Arg2\",\"Cacna1d\",\"Mir155hg\",\"Cdk14\",\"Pde7b\",\"Hdac9\",\"Aoah\",\"Gm14636\",\"Gvin1\",\"Slc13a3\",\"Cers6\",\"Tmtc2\",\"Alpk1\",\"Gm4951\",\"Dennd1a\",\"Clcn5\",\"Ext1\",\"Tmcc3\",\"Lpp\",\"Egfr\",\"Cd209c\",\"Ly6c2\",\"F10\",\"Ass1\",\"Fabp5\",\"Cx3cr1\",\"Adam8\",\"Rap2a\",\"Ccr2\",\"Glipr1\",\"Fdps\",\"Arl5c\",\"Vcan\",\"Adap1\",\"Tmsb10\",\"Ms4a4c\",\"Gpr65\",\"AA467197\",\"Lpl\",\"Gngt2\",\"Slamf9\",\"Inhbb\",\"Tmem252\",\"Akap12\",\"Adamts9\",\"Tll1\",\"2200002D01Rik\",\"Cx3cl1\",\"Pawr\",\"Bace2\",\"Rasip1\",\"Adamts4\",\"Ptprk\",\"Stap2\",\"Sema3f\",\"Apol10b\",\"Rnf125\",\"Pakap.1\",\"Vcam1\",\"Tm4sf1\",\"Sema7a\",\"Aqp7\",\"Timp4\",\"Lims2\",\"Gm12002\",\"Cavin2\",\"Depp1\",\"Ushbp1\",\"Hspa12b\",\"Ccdc85a\",\"Eln\",\"Tcf15\",\"Myct1\",\"Dipk2b\",\"Mcf2l\",\"Tmem204\",\"Tmem255b\",\"Sept4\",\"Lmcd1\",\"Meox2\",\"Ptprb\",\"Nrg2\",\"Gm10790\",\"Prkn\",\"Thrb\",\"Rnf150\",\"Slc9a9\",\"Adcy9\",\"Ank2\",\"Reps2\",\"Ppp1r9a\",\"Cables1\",\"Ophn1\",\"Agmo\",\"Mctp1\",\"2610203C22Rik\",\"Tbc1d4\",\"Zdhhc14\",\"Snx29\",\"Rad51b\",\"Slc16a7\",\"Cxcl13\",\"Fscn1\",\"Src\",\"Ccl12\",\"Mmp9\",\"C3\",\"Il4i1\",\"Slamf8\",\"Tlr1\",\"Clec4n\",\"Ccl5\",\"Glipr1\",\"Ccl8\",\"Tma16\",\"Fgl2\",\"Gpr84\",\"Axl\",\"Mmp25\",\"Tmem176a\",\"Mmp14\",\"Themis\",\"Gm2682\",\"Cd3e\",\"Il2rb\",\"Bcl11b\",\"Nkg7\",\"Ctsw\",\"Skap1\",\"Cd3g\",\"Trbc2\",\"Cd3d\",\"Trac\",\"Tcf7\",\"Camk4\",\"Thy1\",\"Zap70\",\"Ms4a4b\",\"Lef1\",\"Cd5\",\"Sh2d2a\",\"Tmem163\",\"Pax5\",\"Bcl11a\",\"Cpm\",\"Kynu\",\"Rapgef4\",\"Btla\",\"Kcnq5\",\"Cacna1e\",\"Slc9a7\",\"Chst3\",\"Fcrl1\",\"Ap1s3\",\"Pgap1\",\"Setbp1\",\"Bach2\",\"Zfp831\",\"BE692007\",\"Lrrk2\",\"P2ry10\",\"Mrgprb2\",\"Fcer1a\",\"Cma1\",\"Mcpt4\",\"Ms4a2\",\"Tpsb2\",\"Gm47599\",\"Tph1\",\"Cyp11a1\",\"Tpsg1\",\"Tpsab1\",\"Mrgprb1\",\"Cpa3\",\"Atp8b5\",\"Slc6a4\",\"Mrgprx2\",\"Slc18a2\",\"Rab27b\",\"Hs6st2\",\"Cd200r3\",\"Alox15\",\"Prg4\",\"Cd5l\",\"Marco\",\"Vmn2r26\",\"Ltbp1\",\"Mlxipl\",\"Fabp7\",\"Naip1\",\"Gm20619\",\"Aspa\",\"Ptgis\",\"F7\",\"Slpi\",\"Gm13986\",\"F5\",\"Fn1\",\"Thbs1\",\"Prtn3\",\"Adgb\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>p_val<\\/th>\\n      <th>avg_log2FC<\\/th>\\n      <th>pct.1<\\/th>\\n      <th>pct.2<\\/th>\\n      <th>p_val_adj<\\/th>\\n      <th>cluster<\\/th>\\n      <th>gene<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"lengthMenu\":[10,25,50,100],\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3,4,5,6]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"p_val\",\"targets\":1},{\"name\":\"avg_log2FC\",\"targets\":2},{\"name\":\"pct.1\",\"targets\":3},{\"name\":\"pct.2\",\"targets\":4},{\"name\":\"p_val_adj\",\"targets\":5},{\"name\":\"cluster\",\"targets\":6},{\"name\":\"gene\",\"targets\":7}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n## VST\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n top_genes_vst <- read.csv(paste0(out_data_dir,tag,\"_markers_vst_res0.2.csv\"))\n\ndatatable(\n  top_genes_vst,\n  options = list(pageLength = 10, lengthMenu = c(10, 25, 50, 100)),\n  rownames = TRUE\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-c1793a3ab17988a59857\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c1793a3ab17988a59857\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\",\"194\",\"195\",\"196\",\"197\",\"198\",\"199\",\"200\",\"201\",\"202\",\"203\",\"204\",\"205\",\"206\",\"207\",\"208\",\"209\",\"210\",\"211\",\"212\",\"213\",\"214\",\"215\",\"216\",\"217\",\"218\",\"219\",\"220\",\"221\",\"222\",\"223\",\"224\",\"225\",\"226\",\"227\",\"228\",\"229\",\"230\",\"231\",\"232\",\"233\",\"234\",\"235\",\"236\",\"237\",\"238\",\"239\",\"240\",\"241\",\"242\",\"243\",\"244\",\"245\",\"246\",\"247\",\"248\",\"249\",\"250\",\"251\",\"252\",\"253\",\"254\",\"255\",\"256\",\"257\",\"258\",\"259\",\"260\"],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4.85831798951263e-273,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8.58126596010952e-220,0,0,0,0,0,0,0,0,0,0,0,0,0,1.21717623906197e-62,0,0,1.69169764671437e-305,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.07906015805356e-165,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[3.51102139396581,3.48926156765228,3.36427730663219,3.32262304979932,3.20624099684527,3.20565349033493,3.1943249500194,3.04181035341826,3.01175763684618,2.99443221639386,2.89140948941591,2.86026742561827,2.82021960028814,2.75999621021022,2.70895108894382,2.62925203785619,2.6090202582557,2.60901145048227,2.59479978745918,2.53735214547165,4.58533850235134,4.37418096607399,4.185234506086,3.99283496008947,3.96103597959523,3.81850762684079,3.8176540533074,3.70561697099741,3.57608445936378,3.54301995511915,3.35368486410149,3.30472153377704,3.30446186577084,3.29922445040171,3.28449773216078,3.20480073494813,3.14499569464526,3.1283697387527,3.09719271141247,3.09593449501833,10.0603913201321,9.58694256540293,9.534175424032179,9.483072487992439,9.43202031014831,9.31210066920891,9.287366653084741,9.21239334183713,8.99078413514445,8.76057798057851,8.71218364396119,8.626836329492621,8.386023449879399,8.36295364967512,8.232432987969791,8.22297676852811,8.174931890786439,7.9553469281823,7.89364621675835,7.53838488825683,9.02210115596826,8.62225853151973,8.43990314179708,8.265264852048359,8.16416005084643,7.51985597833285,7.36225733892834,7.34765478330878,7.24561990473679,7.08124561538114,6.82567414289829,6.40114454728693,6.3951379665555,6.2103658618386,6.08960035480392,5.91015665554973,5.87969301893681,5.76248235942094,5.74083086038485,5.70255303310477,10.8213430685343,10.6629731626815,9.79551112603813,9.78317352264532,9.44020965952082,9.37088552065074,9.283955321751369,9.01925816442097,8.72989806396876,8.65312167963056,8.591609511897721,8.526088657098089,8.522226719556119,8.32000998639473,8.27837303339037,8.081975694466511,8.06048382345447,7.77404312958657,7.75718329921339,7.70809101063663,8.03688613768683,7.95394298622789,7.9435002900885,7.93477935012661,7.85329983102408,7.74455896236188,7.7183245249583,7.66819780493949,7.65440223647068,7.65014536138225,7.64273853627042,7.61630185113998,7.53172288111105,7.51542822126635,7.51436927173335,7.4497910210786,7.42486797239835,7.24979445450741,7.19026191258929,7.18637071321796,3.40011644685216,2.96201287688542,2.7976394550163,2.75657274904497,2.74048949196084,2.72278709785761,2.66744143657263,2.6419510893151,2.57655829702951,2.44322887080781,2.26550946998327,2.20103326927377,2.18147397427944,2.10629839742116,1.98813822886842,1.98446938151682,1.98218492661751,1.96803897157756,1.9610640900316,1.94391325780758,9.23525410518978,9.044096482216659,9.019266290283049,8.982765616517931,8.937930624969409,8.93212137948875,8.926741775327811,8.91694570738284,8.83698248841443,8.73130640689214,8.35381002156759,8.271406494506641,8.076941430378371,7.37946298949913,7.23294014631954,6.86559583063482,6.6075244544417,6.60317957571506,6.6006951984264,6.45160284727728,3.99510323010396,3.85688994008533,3.7495016094173,3.71674510435581,3.71170309052719,3.7001842568596,3.67491771618987,3.56073734543371,3.5344757272921,3.49475880340753,3.39732085712904,3.37429599325402,3.33835463314668,3.28844948194326,3.28658397149254,3.22937637490466,3.2076487137117,3.20051010669781,3.19767421373299,3.13566456945885,8.27430170684387,7.67793481932347,7.04335766198794,6.46457158400887,6.36458394639178,6.22634623645181,6.2069617562953,6.07482364895794,5.64283763415055,5.49687139193964,5.4933161641413,5.47716513360339,5.36997386137809,5.31083389510735,5.18840710906944,5.13034483471121,5.10259705417041,5.07985169970353,5.06139417734512,5.02514536784699,7.99767934494103,7.87506941337306,7.7676780592673,7.70860556648416,7.59154261107268,7.32170831551159,6.91050172201056,6.80008078420308,6.72095720374859,6.66346328364209,6.60514138718868,6.45408682180609,6.36936023859331,6.36278311900371,6.33353578853932,6.29150856870659,6.05281361795683,6.02069778772176,5.99784527584715,5.98756502585375,4.66846589212428,4.47558071566297,4.47548675886913,4.37832900200189,4.37482292697653,4.22583725828715,4.07259444582708,4.07038497002964,4.05850680767334,4.05848244646118,4.04208035884081,4.03771907909225,4.00614369442567,3.99394475793481,3.98850184282933,3.98843179074085,3.95944612712935,3.95851993049937,3.94033918148931,3.88974324673732,11.8161087302505,11.0784176380949,11.0157250875481,10.9251334089714,10.1994750736467,9.608983753764569,9.451986210602829,9.439299941534561,9.369599393758049,9.14470264327761,9.089398284648681,8.590756687723299,8.547441945183801,8.50437576885893,8.37821042729443,8.36402189921534,8.30846313292234,8.30725612918839,8.00059320843298,7.15980425052627],[0.983,0.973,0.985,0.994,0.6840000000000001,0.99,0.461,0.917,0.256,0.993,0.974,0.484,0.316,0.857,0.861,0.578,0.625,0.862,0.876,0.296,0.426,0.583,0.452,0.27,0.619,0.313,0.464,0.8129999999999999,0.279,0.343,0.697,0.334,0.452,0.444,0.491,0.308,0.984,0.766,0.755,0.828,0.311,0.8139999999999999,0.423,0.8139999999999999,0.831,0.273,0.611,0.833,0.505,0.626,0.357,0.922,0.279,0.283,0.436,0.306,0.4,0.355,0.361,0.338,0.799,0.969,0.593,0.449,0.365,0.304,0.746,0.298,0.352,0.308,0.623,0.455,0.413,0.855,0.474,0.774,0.996,0.5580000000000001,0.885,0.358,0.27,0.315,0.324,0.338,0.306,0.333,0.32,0.311,0.338,0.27,0.257,0.523,0.482,0.6889999999999999,0.284,0.338,0.333,0.378,0.284,0.45,0.9409999999999999,0.616,0.664,0.652,0.391,0.569,0.524,0.5629999999999999,0.6870000000000001,0.473,0.8120000000000001,0.841,0.853,0.388,0.344,0.304,0.58,0.761,0.912,0.251,0.264,0.349,0.273,0.337,0.354,0.422,0.513,0.484,0.354,0.411,0.439,0.477,0.423,0.363,0.373,0.477,0.401,0.338,0.497,0.362,0.611,0.97,0.778,0.555,0.275,0.739,0.302,0.338,0.956,0.353,0.641,0.755,0.777,0.384,0.304,0.712,0.774,0.496,0.9350000000000001,0.633,0.257,0.899,0.919,0.696,0.737,0.61,0.97,0.466,0.481,0.411,0.658,0.776,0.919,0.886,0.77,0.519,0.788,0.902,0.279,0.707,0.26,0.304,0.652,0.783,0.578,0.295,0.272,0.601,0.315,0.789,0.272,0.467,0.545,0.366,0.527,0.5659999999999999,0.671,0.795,0.868,0.745,0.278,0.453,0.266,0.532,0.703,0.32,0.432,0.365,0.378,0.338,0.467,0.385,0.314,0.32,0.298,0.297,0.276,0.389,0.319,0.625,0.402,0.345,0.259,0.726,0.8179999999999999,0.972,0.519,0.795,0.322,0.576,0.551,0.6879999999999999,0.527,0.292,0.826,0.974,0.594,0.8,0.826,0.668,0.325,0.716,0.647,0.369,0.488,0.441,0.294,0.327,0.76,0.605,0.5639999999999999,0.321,0.408,0.464,0.293,0.514,0.422,0.8139999999999999,0.275,0.31],[0.385,0.291,0.421,0.621,0.168,0.435,0.053,0.254,0.04,0.68,0.439,0.106,0.057,0.235,0.412,0.115,0.179,0.209,0.279,0.047,0.021,0.03,0.021,0.016,0.049,0.026,0.033,0.154,0.023,0.038,0.117,0.05,0.099,0.057,0.062,0.029,0.517,0.189,0.193,0.195,0.001,0.01,0.002,0.082,0.09,0.001,0.011,0.053,0.004,0.007,0.003,0.044,0.003,0.002,0.004,0.002,0.004,0.003,0.004,0.007,0.006,0.028,0.003,0.001,0.005,0.001,0.008999999999999999,0.001,0.002,0.004,0.008,0.004,0.005,0.164,0.007,0.016,0.111,0.01,0.038,0.011,0,0,0.001,0.002,0.002,0.001,0.004,0.003,0.005,0.002,0.002,0.004,0.036,0.015,0.002,0.014,0.005,0.005,0.004,0.01,0.021,0.004,0.003,0.004,0.002,0.003,0.005,0.004,0.006,0.003,0.01,0.013,0.008999999999999999,0.004,0.002,0.002,0.005,0.012,0.034,0.002,0.029,0.112,0.103,0.055,0.073,0.07199999999999999,0.134,0.06900000000000001,0.076,0.074,0.097,0.08400000000000001,0.137,0.12,0.101,0.105,0.271,0.074,0.132,0.136,0.008,0.128,0.022,0.004,0.004,0.007,0.003,0.004,0.119,0.002,0.005,0.01,0.022,0.006,0.008,0.028,0.042,0.017,0.053,0.027,0.04,0.33,0.398,0.38,0.229,0.233,0.482,0.132,0.107,0.121,0.243,0.277,0.487,0.398,0.334,0.229,0.34,0.518,0.111,0.315,0.002,0.003,0.014,0.031,0.02,0.007,0.008,0.027,0.008999999999999999,0.045,0.01,0.034,0.024,0.014,0.026,0.035,0.09,0.057,0.065,0.07099999999999999,0.002,0.006,0.002,0.006,0.011,0.004,0.006,0.005,0.007,0.008,0.011,0.008,0.008,0.005,0.006,0.007,0.005,0.008999999999999999,0.007,0.045,0.044,0.039,0.028,0.117,0.139,0.282,0.076,0.143,0.038,0.092,0.1,0.115,0.081,0.042,0.174,0.325,0.08500000000000001,0.153,0.149,0.149,0,0.001,0.001,0,0.001,0.002,0,0.001,0.002,0.002,0.004,0.001,0.002,0.004,0.002,0.002,0.002,0.017,0.003,0.002],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.00251391713593e-268,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.7707442308686e-215,0,0,0,0,0,0,0,0,0,0,0,0,0,2.51164316930437e-58,0,0,3.49081809399511e-301,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.22664063614351e-161,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[\"Ccl4\",\"Mt2\",\"Ccl7\",\"Mt1\",\"Cd209a\",\"Sdc4\",\"Lipg\",\"Ccl3\",\"Calhm6\",\"Wfdc17\",\"Ccl9\",\"Timp1\",\"Ch25h\",\"Ifit1\",\"Ccl24\",\"Ifi206\",\"Ccl5\",\"Mmp14\",\"Rsad2\",\"4930430E12Rik\",\"Tmem37\",\"Chp2\",\"Gpr34\",\"Tslp\",\"Hpgd\",\"Tmem141\",\"Selenbp1\",\"Ltc4s\",\"Rac3\",\"Cd209g\",\"Rnase4\",\"Pla2g2d\",\"Cd209f\",\"Ang\",\"Tnfsf13\",\"Hfe\",\"Selenop\",\"Lyve1\",\"Fxyd2\",\"Fcgrt\",\"Mrgprb2\",\"Fcer1a\",\"Ms4a2\",\"Cma1\",\"Mcpt4\",\"Gm47599\",\"Tph1\",\"Tpsb2\",\"Cyp11a1\",\"Mrgprb1\",\"Tpsab1\",\"Cpa3\",\"Atp8b5\",\"Mrgprx2\",\"Rab27b\",\"Slc6a4\",\"Hs6st2\",\"Cd200r3\",\"Slc18a2\",\"Il4\",\"Alox15\",\"Prg4\",\"Cd5l\",\"Vmn2r26\",\"Marco\",\"Mlxipl\",\"Ltbp1\",\"Naip1\",\"Fabp7\",\"Gm20619\",\"Aspa\",\"Ptgis\",\"F7\",\"Slpi\",\"Gm13986\",\"F5\",\"Fn1\",\"Adgb\",\"Thbs1\",\"Prtn3\",\"Ccl21a\",\"Mmrn1\",\"Fndc1\",\"Reln\",\"Sema3a\",\"Serpina3n\",\"Col3a1\",\"Col1a1\",\"Col1a2\",\"Col6a2\",\"Col6a1\",\"Abi3bp\",\"Dcn\",\"Serping1\",\"Ddr2\",\"Apod\",\"Rarres2\",\"Rbms3\",\"Adamtsl1\",\"Igfbp5\",\"Cd79a\",\"Pax5\",\"Cd19\",\"Mzb1\",\"2010309G21Rik\",\"Pou2af1\",\"Fcmr\",\"Gm30211\",\"Iglc3\",\"Iglc1\",\"Iglc2\",\"Ly6d\",\"Ms4a1\",\"Tmem163\",\"Spib\",\"Agbl1\",\"Cd22\",\"Igkc\",\"Cd79b\",\"Il5ra\",\"F10\",\"Fabp5\",\"Lyz1\",\"Rap2a\",\"Ass1\",\"Glipr1\",\"Ms4a4c\",\"Ccr2\",\"Vcan\",\"Arl5c\",\"Slamf8\",\"Bcl2a1d\",\"Lpl\",\"AA467197\",\"Scimp\",\"Basp1\",\"Cxcl13\",\"Gpr65\",\"Plbd1\",\"Slamf9\",\"G0s2\",\"S100a9\",\"Retnlg\",\"Chil1\",\"Cstdc4\",\"Il1f9\",\"Stfa2l1\",\"Asprv1\",\"S100a8\",\"Mrgpra2b\",\"Cxcr2\",\"Il1r2\",\"Wfdc21\",\"H2-Q10\",\"Mmp8\",\"Trem1\",\"Pglyrp1\",\"Trem3\",\"Slc7a11\",\"Arg2\",\"Fap\",\"Cacna1d\",\"Cdk14\",\"Hdac9\",\"Mir155hg\",\"Pde7b\",\"Aoah\",\"Gm14636\",\"Gvin1\",\"Slc13a3\",\"Gm4951\",\"Alpk1\",\"Dennd1a\",\"Cers6\",\"Clcn5\",\"Egfr\",\"Tmcc3\",\"Ext1\",\"Tmtc2\",\"Mir99ahg\",\"Fjx1\",\"Inhbb\",\"Tmem252\",\"Adamts9\",\"2200002D01Rik\",\"Tll1\",\"Cx3cl1\",\"Akap12\",\"Bace2\",\"Rasip1\",\"Pawr\",\"Adamts4\",\"Ptprk\",\"Apol10b\",\"Rnf125\",\"Sema7a\",\"Vcam1\",\"Pakap.1\",\"Tm4sf1\",\"Mast4\",\"Aqp7\",\"Timp4\",\"Gm12002\",\"Lims2\",\"Cavin2\",\"Depp1\",\"Ushbp1\",\"Hspa12b\",\"Ccdc85a\",\"Eln\",\"Tcf15\",\"Myct1\",\"Mcf2l\",\"Dipk2b\",\"Tmem255b\",\"Tmem204\",\"Lmcd1\",\"Meox2\",\"Sept4\",\"Slc9a3r2\",\"Nrg2\",\"Thrb\",\"Gm10790\",\"Prkn\",\"Rnf150\",\"Slc9a9\",\"Adcy9\",\"Ophn1\",\"Cables1\",\"Reps2\",\"Ank2\",\"Agmo\",\"2610203C22Rik\",\"Ppp1r9a\",\"Zdhhc14\",\"Mctp1\",\"Tbc1d4\",\"Snx29\",\"Plekhg5\",\"Rad51b\",\"Themis\",\"Gm2682\",\"Cd3e\",\"Bcl11b\",\"Il2rb\",\"Nkg7\",\"Trbc2\",\"Ctsw\",\"Skap1\",\"Cd3d\",\"Cd3g\",\"Trac\",\"Camk4\",\"Tcf7\",\"Zap70\",\"Thy1\",\"Lef1\",\"Ms4a4b\",\"Cd5\",\"Sh2d2a\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>p_val<\\/th>\\n      <th>avg_log2FC<\\/th>\\n      <th>pct.1<\\/th>\\n      <th>pct.2<\\/th>\\n      <th>p_val_adj<\\/th>\\n      <th>cluster<\\/th>\\n      <th>gene<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"lengthMenu\":[10,25,50,100],\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3,4,5,6]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"p_val\",\"targets\":1},{\"name\":\"avg_log2FC\",\"targets\":2},{\"name\":\"pct.1\",\"targets\":3},{\"name\":\"pct.2\",\"targets\":4},{\"name\":\"p_val_adj\",\"targets\":5},{\"name\":\"cluster\",\"targets\":6},{\"name\":\"gene\",\"targets\":7}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nThe marker gene lists are also attached in the shared Google folder as csv files.\n\n# Rough cell type annotations\n\nNext I did some rough cell type annotation based on markers we identified in December, 2024.\n\n## SCT\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nload(file=paste0(proj_dir,\"output/processed/03.2_SI_seurat_sct.Robj\"))\nfeatures_celltypes <- c(\n  \"Ccr2\", \"Irf5\", \"S100a4\", \"Adgre1\", \n  \"Csf1r\", \"Folr2\", \n  \"Mmp9\", \"Lcn2\", \"Retnlg\", \"S100a8\", \n  \"Pecam1\", \n  \"Cldn5\", \"Emcn\", \"Sox17\", \n  \"Kit\", \"Cpa3\", \"Tpsb2\",\n  \"Des\", \"Acta2\", \"Pdgfrb\", \n  \"Cd19\", \"Blk\", \"Cd22\"\n)\n\nDefaultAssay(seurat_sct) <- \"RNA\" \np1 <- DotPlot(seurat_sct, features = features_celltypes, group.by = \"seurat_clusters\",\n        col.min = -1,\n        col.max = 2,\n        dot.scale = 5) +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1.0, size = 12),\n        axis.text.y = element_text(angle = 0, hjust = 1.0, size = 15)) +\n  labs(x = NULL, y = NULL) + ggtitle(\"SCT\")\n\nseurat_sct@meta.data[,'celltype'] <- as.numeric(seurat_sct@active.ident)-1\nseurat_sct@meta.data$celltype[which(seurat_sct@active.ident %in% c(5))] <- 'Monocytes'\nseurat_sct@meta.data$celltype[which(seurat_sct@active.ident %in% c(0, 1, 8, 9))] <- 'Macrophages'\nseurat_sct@meta.data$celltype[which(seurat_sct@active.ident %in% c(3))] <- 'Neutrophils'\nseurat_sct@meta.data$celltype[which(seurat_sct@active.ident %in% c(6,7))] <- 'Endothelial cells'\nseurat_sct@meta.data$celltype[which(seurat_sct@active.ident %in% c(12))] <- 'Mast cells'\nseurat_sct@meta.data$celltype[which(seurat_sct@active.ident %in% c(2, 11))] <- 'B-cells'\nseurat_sct@meta.data$celltype[which(seurat_sct@active.ident %in% c(13, 10, 4))] <- 'Unknown'\nseurat_sct@meta.data$celltype[which(seurat_sct@meta.data$sample %in% c(\"PVM\"))] <- 'PVM'\n\np2 <- DimPlot(seurat_sct, repel = TRUE, label = FALSE, \n        pt.size = 0.5, group.by = \"celltype\") + \n  NoAxes() + labs(title = NULL)\np1 + p2\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/celltype_plots_sct-1.png){fig-align='center' width=90%}\n:::\n\n```{.r .cell-code}\np3 <- DimPlot(seurat_sct, repel = TRUE, label = FALSE, \n        pt.size = 0.5, group.by = \"celltype\", split.by = \"orig.ident\") + \n  NoAxes() + labs(title = NULL)\np3\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/celltype_plots_sct-2.png){fig-align='center' width=90%}\n:::\n\n```{.r .cell-code}\np4 <- DotPlot(seurat_vst, features = features_celltypes, group.by = \"seurat_clusters\",\n        col.min = -1,\n        col.max = 2,\n        dot.scale = 5) +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1.0, size = 12),\n        axis.text.y = element_text(angle = 0, hjust = 1.0, size = 15)) +\n  labs(x = NULL, y = NULL) + ggtitle(\"VST\")\n```\n:::\n\n\n\n## VST\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nseurat_vst@meta.data[,'celltype'] <- as.numeric(seurat_vst@active.ident)-1\nseurat_vst@meta.data$celltype[which(seurat_vst@active.ident %in% c(3))] <- 'Monocytes'\nseurat_vst@meta.data$celltype[which(seurat_vst@active.ident %in% c(0, 1, 8))] <- 'Macrophages'\nseurat_vst@meta.data$celltype[which(seurat_vst@active.ident %in% c(4))] <- 'Neutrophils'\nseurat_vst@meta.data$celltype[which(seurat_vst@active.ident %in% c(6,7))] <- 'Endothelial cells'\nseurat_vst@meta.data$celltype[which(seurat_vst@active.ident %in% c(10))] <- 'Mast cells'\nseurat_vst@meta.data$celltype[which(seurat_vst@active.ident %in% c(2))] <- 'B-cells'\nseurat_vst@meta.data$celltype[which(seurat_vst@active.ident %in% c(9, 5, 12, 11))] <- 'Unknown'\nseurat_vst@meta.data$celltype[which(seurat_vst@meta.data$sample %in% c(\"PVM\"))] <- 'PVM'\n\np5 <- DimPlot(seurat_vst, repel = TRUE, label = FALSE, \n        pt.size = 0.5, group.by = \"celltype\") + \n  NoAxes() + labs(title = NULL)\np4 + p5\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/celltype_plots_vst-1.png){fig-align='center' width=90%}\n:::\n\n```{.r .cell-code}\np6 <- DimPlot(seurat_vst, repel = TRUE, label = FALSE, \n        pt.size = 0.5, group.by = \"celltype\", split.by = \"orig.ident\") + \n  NoAxes() + labs(title = NULL)\np6\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/celltype_plots_vst-2.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n# Subset PVM\n\nNext I subsetted the PVM compartment from both full objects.\n\n## SCT\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(future)\noopts <- options(future.globals.maxSize = 1.0 * 1e9)  ## 1.0 GB\non.exit(options(oopts))\nf <- future({ expr })\n\npvm_sct <- subset(seurat_sct, subset = sample == \"PVM\")\npvm_sct <- SCTransform(pvm_sct)\npvm_sct <- RunPCA(pvm_sct, npcs = 50)\n\nElbowPlot(pvm_sct)\nselected_dims <- select_dims(pvm_sct, \"pca\")\n\nset.seed(123)\npvm_sct <- RunUMAP(pvm_sct, dims = 1:21)\npvm_sct <- FindNeighbors(pvm_sct)\npvm_sct <- FindClusters(pvm_sct, resolution = 0.2)\nsave(pvm_sct, file=paste0(sobj_dir,tag,\"_pvm_sct.Robj\"))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nload(paste0(sobj_dir,tag,\"_pvm_sct.Robj\"))\np1 <- DimPlot(pvm_sct, group.by = \"orig.ident\", cols = sample_colors) + ggtitle(\"SCT\")\np2 <- DimPlot(pvm_sct)\np1 + p2\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/plot_pvm_sct-1.png){fig-align='center' width=90%}\n:::\n\n```{.r .cell-code}\nDimPlot(pvm_sct, split.by = \"orig.ident\")\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/plot_pvm_sct-2.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n## VST\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(future)\noopts <- options(future.globals.maxSize = 1.0 * 1e9)  ## 1.0 GB\non.exit(options(oopts))\nf <- future({ expr })\n\npvm_vst <- subset(seurat_vst, subset = sample == \"PVM\")\npvm_vst <- NormalizeData(pvm_vst, npcs = 50)\npvm_vst <- ScaleData(pvm_vst, npcs = 50)\npvm_vst <- RunPCA(pvm_vst, npcs = 50)\n\nElbowPlot(pvm_vst)\nselected_dims <- select_dims(pvm_vst, \"pca\")\n\nset.seed(123)\npvm_vst <- RunUMAP(pvm_vst, dims = 1:16)\npvm_vst <- FindNeighbors(pvm_vst)\npvm_vst <- FindClusters(pvm_vst, resolution = 0.2)\nsave(pvm_vst, file=paste0(sobj_dir,tag,\"_pvm_vst.Robj\"))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nload(paste0(sobj_dir,tag,\"_pvm_vst.Robj\"))\np1 <- DimPlot(pvm_vst, group.by = \"orig.ident\", cols = sample_colors) + ggtitle(\"SCT\")\np2 <- DimPlot(pvm_vst)\np1 + p2\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/plot_pvm_vst-1.png){fig-align='center' width=90%}\n:::\n\n```{.r .cell-code}\nDimPlot(pvm_vst, split.by = \"orig.ident\")\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/plot_pvm_vst-2.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n#PVM Markers\n\nNext I foudn marker genes for both subsetted PVM objects. Once again, for the SCTransform object, the assay was first changed to RNA.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nDefaultAssay(pvm_sct) <- \"RNA\" \npvm_sct <- NormalizeData(pvm_sct)\npvm_sct <- ScaleData(pvm_sct)\ndegs_pvm_sct <- FindAllMarkers(pvm_sct, only.pos = TRUE, \n                           assay = \"RNA\",\n                           min.pct = 0.25, logfc.threshold = 0.1)\n\n# Extract top 20 genes for each cluster\ntop_genes <- degs_pvm_sct %>%\n  group_by(cluster) %>%\n  arrange(desc(avg_log2FC)) %>%\n  slice_head(n = 20)\n\n# Save to CSV file\nwrite.csv(top_genes, paste0(out_data_dir,tag,\"_pvm_markers_sct_res0.2.csv\"), \n          row.names = FALSE)\n\n#VST\ndegs_pvm_vst <- FindAllMarkers(pvm_vst, only.pos = TRUE, \n                           assay = \"RNA\",\n                           min.pct = 0.25, logfc.threshold = 0.1)\n\n# Extract top 20 genes for each cluster\ntop_genes <- degs_pvm_vst %>%\n  group_by(cluster) %>%\n  arrange(desc(avg_log2FC)) %>%\n  slice_head(n = 20)\n\n# Save to CSV file\nwrite.csv(top_genes, paste0(out_data_dir,tag,\"_pvm_markers_vst_res0.2.csv\"), \n          row.names = FALSE)\n```\n:::\n\n\n\n## SCT\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(DT)\ntop_genes_sct <- read.csv(paste0(out_data_dir,tag,\"_pvm_markers_sct_res0.2.csv\"))\n\ndatatable(\n  top_genes_sct,\n  options = list(pageLength = 10, lengthMenu = c(10, 25, 50, 100)),\n  rownames = TRUE\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-64e630377b2e2f006243\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-64e630377b2e2f006243\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\"],[0,0,0,0,0,0,4.2145555199717e-210,0,0,0,0,0,0,0,0,0,0,0,0,2.74878105179935e-284,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.20841960637342e-191,0,0,0,8.691542457646609e-255,7.55135503140467e-208,0,0,0,3.1434813663126e-219,2.09349113306802e-213,3.84870591333856e-62,0,0,0,3.41550691777413e-198,0,0,3.41777434478095e-292,0,0,0,0,0,1.70294990550465e-209,4.65960309418442e-292,0,4.97201397636632e-201,0,0,1.18664937397472e-250,0,2.44881986155114e-275,0,2.22375040890312e-219,1.39897116900049e-247,3.57714416292781e-147,0,1.17096025896452e-240,0,0,2.06409915566784e-166,0,0,0,0,0,0,4.40670860486162e-306,1.13052477058561e-291,0,0,0,0,9.743707001552461e-214,0,2.28556121099519e-247,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.64433992186367e-180,0,0,4.41258849695003e-16,2.19740147565419e-111,4.18848029986578e-162,2.07452659904391e-165],[3.82067533664774,3.38186821908299,3.33438838169712,3.17291929827033,3.15557519053244,2.97492616282221,2.89860249666033,2.85913394635256,2.85087735892675,2.8343535072546,2.82381808171039,2.60109873150222,2.58524416284604,2.44434319181775,2.4250047892158,2.41151140006224,2.39556662277041,2.35777395797671,2.35225006671054,2.34839637239046,4.35673778117193,4.25111698462467,4.17147673372922,4.00861489961634,3.77065420121422,3.64227377664375,3.6120933984232,3.60304369077045,3.60061982023554,3.46386405989076,3.3578048469109,3.32219425921649,3.32057030508846,3.28793790090168,3.23827680554947,3.23293404377862,3.20644109998683,3.20482012539546,3.17418603689543,3.15860392545409,3.65445109871934,3.33030643210367,3.29680283772085,3.25656006999775,3.25020531653448,3.20583456156562,3.19577865818973,3.19427055232448,3.16698304686621,3.05732759034754,3.0505795684845,3.03562337421352,2.93109945478014,2.92709034027036,2.91015331567989,2.90645935299076,2.84744929773799,2.84695963483689,2.8357999691917,2.81498173697471,4.14283198973282,3.21419440791303,3.21256445265719,2.93470233607403,2.91342653533009,2.72863290064288,2.66005504398956,2.60966447992011,2.60142714730764,2.5879358448299,2.44082240268657,2.37714638377003,2.27748188324208,2.27413961109617,2.2320524957737,2.17758718690934,2.16463619816251,2.15704223360891,2.14679325326534,2.04743446396426,4.07097350398615,3.98616127557992,3.96279288010114,3.95947616289693,3.94059484405988,3.89592050892567,3.88087851486828,3.85607710781303,3.80517731050939,3.80144706718279,3.77553836185312,3.76351422412423,3.75942395892712,3.74404587125455,3.7413747488626,3.72969411944025,3.67869279536675,3.66688418216465,3.6500515484281,3.64607618295182,13.8540568541164,11.4119451732815,10.886946167982,10.7296524615466,9.58350686009187,9.373820692822131,8.73557749127446,8.54745947264157,8.480245395459271,8.320039284536991,7.8272951757997,7.56780895946868,7.05594966044651,6.60407167352758,6.46586110920164,6.22448658850809,4.98707513526907,4.91988973468221,4.61767350512381,4.24650323303919],[0.593,0.984,0.485,0.87,0.992,0.267,0.409,0.997,0.998,0.872,0.9370000000000001,0.955,0.894,0.311,0.994,0.253,0.731,0.47,0.421,0.335,0.676,0.435,0.361,0.322,0.573,0.484,0.316,0.321,0.265,0.921,0.261,0.481,0.501,0.387,0.271,0.333,0.495,0.506,0.882,0.364,0.269,0.741,0.909,0.522,0.627,0.72,0.895,0.93,0.717,0.498,0.472,0.252,0.987,0.946,0.767,0.412,0.872,0.797,0.532,0.772,0.863,0.609,0.463,0.8,0.256,0.32,0.338,0.409,0.414,0.737,0.443,0.464,0.43,0.573,0.264,0.5679999999999999,0.29,0.996,0.36,0.455,0.437,0.267,0.415,0.553,0.841,0.786,0.75,0.991,0.342,0.364,0.472,0.354,0.406,0.833,0.254,0.656,0.327,0.493,0.396,0.59,0.264,0.278,0.275,0.292,0.407,0.269,0.264,0.295,0.309,0.35,0.292,0.358,0.261,0.281,0.312,0.275,0.281,0.307,0.301,0.261],[0.24,0.429,0.113,0.248,0.43,0.046,0.201,0.836,0.852,0.264,0.338,0.391,0.333,0.062,0.623,0.031,0.229,0.107,0.107,0.093,0.042,0.028,0.02,0.025,0.04,0.037,0.024,0.03,0.02,0.245,0.026,0.063,0.049,0.038,0.021,0.035,0.06,0.06900000000000001,0.265,0.056,0.066,0.325,0.523,0.165,0.352,0.571,0.52,0.594,0.294,0.225,0.196,0.128,0.781,0.614,0.419,0.16,0.513,0.434,0.215,0.452,0.389,0.095,0.064,0.242,0.047,0.053,0.046,0.127,0.08500000000000001,0.313,0.123,0.097,0.107,0.142,0.046,0.201,0.082,0.721,0.08,0.08500000000000001,0.073,0.06,0.065,0.113,0.194,0.187,0.17,0.426,0.054,0.067,0.08500000000000001,0.055,0.078,0.215,0.041,0.128,0.061,0.089,0.074,0.119,0,0.001,0,0.002,0.002,0.001,0.001,0.003,0.002,0.003,0.004,0.005,0.004,0.023,0.008999999999999999,0.01,0.141,0.046,0.03,0.021],[0,0,0,0,0,0,8.69673531546161e-206,0,0,0,0,0,0,0,0,0,0,0,0,5.67210970038796e-280,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.49357385775155e-187,0,0,0,1.79349978613538e-250,1.55822211073035e-203,0,0,0,6.48657379938604e-215,4.31991895308587e-209,7.941804652174121e-58,0,0,0,7.047898524826911e-194,0,0,7.05257736045549e-288,0,0,0,0,0,3.51403713000885e-205,9.61509098484955e-288,0,1.02597508402319e-196,0,0,2.44865098319683e-246,0,5.05313978431077e-271,0,4.58870896877158e-215,2.88677700723251e-243,7.38143698020153e-143,0,2.41627649437329e-236,0,0,4.2592686077206e-162,0,0,0,0,0,0,9.09324320613195e-302,2.33283786410341e-287,0,0,0,0,2.01061393977035e-209,0,4.71625555888858e-243,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5.45659542876568e-176,0,0,9.10537636345639e-12,4.53433794501243e-107,8.642929098773031e-158,4.2807856371271e-161],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],[\"Saa3\",\"Mt2\",\"Timp1\",\"Il1rn\",\"Ccl4\",\"Calhm6\",\"AW112010\",\"Mt1\",\"Wfdc17\",\"Ifit1\",\"Ccl3\",\"Isg15\",\"Cxcl10\",\"Id3\",\"Sdc4\",\"Selp\",\"Ifi47\",\"Isg20\",\"Hbegf\",\"Ch25h\",\"Chp2\",\"Tmem37\",\"Bmyc\",\"Tmem141\",\"Ypel3\",\"Gpr34\",\"Dbp\",\"Tslp\",\"Tnfrsf17\",\"Ptpn18\",\"AI467606\",\"Fam89b\",\"Selenbp1\",\"Lyl1\",\"Cracr2b\",\"Hfe\",\"Sult1a1\",\"Lamtor4\",\"Ltc4s\",\"Tppp3\",\"Fap\",\"Mir155hg\",\"Cacna1d\",\"Gvin1\",\"Pde7b\",\"Hdac9\",\"Cers6\",\"Cdk14\",\"Abtb2\",\"Slco3a1\",\"Gm14636\",\"Tmtc2\",\"Aoah\",\"Lpp\",\"Herc6\",\"Olfr56\",\"Ascc3\",\"Alpk1\",\"Gm4070\",\"Dst\",\"Cxcl13\",\"Fscn1\",\"Glipr1\",\"Cd52\",\"Il4i1\",\"Arl5c\",\"Bcl2a1a\",\"Ly6a\",\"C3\",\"Mmp9\",\"Lpl\",\"Basp1\",\"Limd2\",\"Slamf8\",\"Mmp25\",\"Fgl2\",\"Ccnd1\",\"Ccl12\",\"Gpr65\",\"Vcam1\",\"Nrg2\",\"Naaladl2\",\"Nr3c2\",\"Aff3\",\"Snx29\",\"Prkn\",\"Agmo\",\"Mctp1\",\"Gm10790\",\"Thrb\",\"Gab3\",\"Cables1\",\"Mcc\",\"Rnf150\",\"5033421B08Rik\",\"Tbc1d4\",\"Sema6a\",\"Gm4258\",\"4933406I18Rik\",\"Prkag2\",\"Iglc2\",\"Ly6d\",\"Ms4a1\",\"Cd79a\",\"Ebf1\",\"Ikzf3\",\"Ptprcap\",\"Ltb\",\"Setbp1\",\"Ablim1\",\"Napsa\",\"Cytip\",\"Cd2\",\"Cd79b\",\"Ets1\",\"Sox5\",\"Tpm1\",\"Cd9\",\"Sell\",\"Itpr1\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>p_val<\\/th>\\n      <th>avg_log2FC<\\/th>\\n      <th>pct.1<\\/th>\\n      <th>pct.2<\\/th>\\n      <th>p_val_adj<\\/th>\\n      <th>cluster<\\/th>\\n      <th>gene<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"lengthMenu\":[10,25,50,100],\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3,4,5,6]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"p_val\",\"targets\":1},{\"name\":\"avg_log2FC\",\"targets\":2},{\"name\":\"pct.1\",\"targets\":3},{\"name\":\"pct.2\",\"targets\":4},{\"name\":\"p_val_adj\",\"targets\":5},{\"name\":\"cluster\",\"targets\":6},{\"name\":\"gene\",\"targets\":7}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n## VST\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntop_genes_vst <- read.csv(paste0(out_data_dir,tag,\"_pvm_markers_vst_res0.2.csv\"))\n\ndatatable(\n  top_genes_vst,\n  options = list(pageLength = 10, lengthMenu = c(10, 25, 50, 100)),\n  rownames = TRUE\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-fa9825a23036a13a1b0b\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-fa9825a23036a13a1b0b\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\"],[3.43932253130678e-243,0,0,6.82770444783652e-235,2.97214626871318e-183,3.97070144853843e-301,3.96803093881237e-154,2.7099564243383e-189,2.28055268887273e-279,0,0,1.57138179611198e-203,0,0,9.93117596668703e-179,0,7.2576215317042e-297,0,0,3.72146761279048e-202,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7.29605279022759e-216,0,0,1.27219033817133e-219,0,0,0,0,0,0,1.00589008964464e-301,0,0,0,1.95038741746492e-307,0,2.61142687188962e-231,7.73950654157643e-193,0,0,0,2.38083723243792e-257,6.92270508355641e-216,0,0,0,2.38221417475797e-222,3.74155971780572e-214,2.02998990005065e-63,0,0,1.05370378493652e-198,0,3.9296527460006e-295,0,0,0,0,9.966293466845421e-229,0,2.08394069243584e-157,0,0,0,0,6.75560598298671e-298,1.65186354806787e-299,0,0,0,0,0,0,4.94544468790426e-247,7.3310917012772e-210,0,0,0,0,4.92694787196545e-299,0,5.15902781966982e-229,2.93440841950736e-220,3.43313695439258e-135,8.68724210415419e-295,1.93286321077341e-111,3.84315651589335e-216,4.12122187446756e-268,2.03323188422155e-148,1.47393009078821e-132,2.47636339518608e-239,1.56445491719782e-209,3.62509469249543e-300,1.77900631134819e-272,0,1.28437417876109e-175,1.04268774627925e-134,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3.42201504198507e-87,9.86578237826526e-85,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.95519877168428e-199,6.85664343521204e-119,5.998470310582579e-244,1.16515304574259e-76,9.29801280490325e-102,1.41014008427913e-185,2.96659152068792e-162,2.43006286035569e-67,5.1575445927579e-62,9.48554830372099e-111,3.24468047600706e-114,9.49437527716925e-174,6.21171332375197e-55,7.13186015703501e-41,1.50096730271239e-113,1.80499316692046e-136,2.42808407856019e-149,2.7871152617817e-182,8.6377667664168e-168,1.18679026636636e-113],[3.15942333816454,2.11921168970418,2.08054354765753,2.05149285246513,1.95189191955818,1.90876872393491,1.85469706538431,1.82420856883279,1.75011234237553,1.70446211237723,1.67568132079428,1.65358572084069,1.61703756739037,1.6035309001707,1.59928786939721,1.5438148720651,1.53764958332419,1.53718132755786,1.5294607375807,1.51664434573712,4.60266975546149,4.39972129715619,4.22491110322973,4.05532204239026,3.87518184848274,3.75908207228346,3.696157162248,3.61721617657997,3.57855025946249,3.48489186700897,3.393184968275,3.38694112937809,3.38201014933123,3.37514709270127,3.3089187582064,3.29622674682735,3.29346937271307,3.26812355424325,3.25718330299644,3.25018272573698,3.26358482839423,2.9231129518667,2.61064164812026,2.27770731958893,2.25965117145652,2.21780117394701,2.08707823742003,2.06221645754987,2.05364694673565,2.04346813010796,2.04277403947143,2.0151341306655,2.01433516326948,2.00741680760676,1.98130004238617,1.96699823189455,1.96590355863476,1.95386433604678,1.88570684756368,1.86111712852226,3.64051040660242,3.3154605614824,3.297177115394,3.26519446100144,3.23890282502804,3.21765992972852,3.19733672572627,3.17518923380367,3.13767273519392,3.07823197232955,3.04655852674075,3.02316804506932,2.92543430657152,2.92480462763532,2.87928384527971,2.87770743728842,2.84893767774256,2.83158582267118,2.8282830439613,2.8090666673719,4.10805742630064,4.07950010240202,4.00555982657475,3.98852200873229,3.95816229907395,3.91130422330803,3.88989197455546,3.87125094134117,3.84669980002779,3.84290896280888,3.8386118414618,3.83094777679946,3.80409201228792,3.76566994327699,3.74473526561395,3.72690084464826,3.69860962873195,3.68580047148653,3.66325928433925,3.63229389568763,3.15631231033508,2.86294998997625,2.82416107569963,2.75268507313062,2.74237682980538,2.67928139442584,2.62946661170043,2.58212811284515,2.55576445137176,2.51866841468537,2.43571469874579,2.41195238345706,2.39402138233638,2.2890033638232,2.19384291480672,2.16351162128122,2.16157714304425,2.06554308207927,2.04445140789938,1.99808182502062,14.4013791600663,13.0136862713922,12.9203632192327,12.5927827157117,12.5239239554742,12.28871604248,12.212232442965,11.918640254093,11.8020233227037,11.5627726960052,11.4359564881971,11.3481119593674,10.902464510393,10.7880137498172,10.7054783410891,10.5132460137806,10.2381134620091,10.2003480908849,9.697674446855039,9.69198185380378,10.8100291338748,10.7443448830456,10.6098997428741,10.5285300019454,10.4871852302209,10.4465854384932,10.3057757809628,10.2481607768027,9.98734357175721,9.978829189160329,9.931992318221139,9.90618134890609,9.81705555498853,9.72087359582607,9.704494310853461,9.67959971633775,9.624600781384061,9.577094155929609,9.53169257445168,9.527758324535171,9.89536937206258,9.770639983518549,9.707002731010849,9.54163614710386,9.534529015668459,9.41524708837458,9.382900396420331,9.33817394058325,9.324440984841999,9.322279845911281,9.310956529436281,9.309389895395579,9.281132515278861,9.24037148920857,9.219120182761699,9.169523899159779,9.10640530242194,9.06984133809382,9.06246081234004,9.03011412825561],[0.271,0.894,0.658,0.589,0.295,0.672,0.291,0.316,0.44,0.499,0.83,0.423,0.648,0.799,0.424,0.829,0.543,0.929,0.96,0.417,0.676,0.432,0.358,0.319,0.572,0.485,0.316,0.317,0.262,0.917,0.499,0.258,0.388,0.477,0.272,0.332,0.492,0.502,0.268,0.719,0.439,0.424,0.99,0.285,0.999,1,0.263,0.999,0.98,0.872,0.457,0.838,0.982,0.511,0.889,0.572,0.962,0.438,0.906,0.509,0.271,0.741,0.912,0.528,0.631,0.728,0.9360000000000001,0.898,0.717,0.501,0.475,0.254,0.989,0.95,0.415,0.768,0.535,0.799,0.874,0.713,0.448,0.253,0.5639999999999999,0.268,0.423,0.841,0.791,0.758,0.347,0.378,0.991,0.481,0.362,0.414,0.833,0.669,0.335,0.26,0.602,0.98,0.579,0.906,0.431,0.338,0.773,0.432,0.451,0.573,0.773,0.541,0.49,0.258,0.279,0.527,0.369,0.903,0.656,0.965,0.474,0.251,0.352,0.37,0.278,0.449,0.273,0.38,0.421,0.37,0.287,0.44,0.472,0.44,0.343,0.255,0.259,0.389,0.278,0.296,0.306,0.347,0.305,0.254,0.297,0.263,0.254,0.305,0.263,0.271,0.297,0.5,0.415,0.263,0.297,0.254,0.322,0.305,0.263,0.288,0.254,0.305,0.292,0.292,0.667,0.958,0.958,0.375,0.25,0.875,0.958,0.583,0.958,0.542,0.958,1,0.375,0.75,0.792,0.375,0.792,0.25],[0.06900000000000001,0.379,0.299,0.299,0.101,0.357,0.113,0.113,0.157,0.167,0.574,0.183,0.327,0.375,0.194,0.62,0.235,0.492,0.673,0.173,0.039,0.027,0.019,0.024,0.038,0.034,0.023,0.03,0.02,0.243,0.047,0.026,0.036,0.062,0.02,0.034,0.058,0.068,0.029,0.1,0.068,0.053,0.399,0.07000000000000001,0.576,0.878,0.057,0.572,0.486,0.419,0.103,0.26,0.452,0.171,0.328,0.15,0.466,0.123,0.328,0.206,0.067,0.326,0.523,0.165,0.351,0.57,0.593,0.52,0.295,0.225,0.196,0.128,0.781,0.614,0.16,0.419,0.215,0.434,0.513,0.414,0.074,0.036,0.115,0.061,0.067,0.198,0.191,0.173,0.055,0.067,0.429,0.08599999999999999,0.056,0.079,0.219,0.13,0.062,0.042,0.121,0.434,0.081,0.269,0.062,0.034,0.337,0.08599999999999999,0.141,0.118,0.423,0.137,0.089,0.043,0.056,0.116,0.062,0.396,0.163,0.52,0.119,0.044,0,0,0,0,0,0,0,0,0,0.001,0.002,0.001,0,0,0,0.001,0,0.037,0.04,0.002,0,0.001,0.001,0.001,0.001,0.002,0,0.001,0.001,0.002,0.003,0.001,0.002,0.001,0.001,0.001,0.001,0.001,0.001,0.002,0.002,0.003,0.008,0.067,0.049,0.003,0.002,0.062,0.08500000000000001,0.015,0.043,0.008,0.097,0.156,0.006,0.021,0.021,0.003,0.019,0.002],[7.09704204335153e-239,0,0,1.40889681281107e-230,6.13302382548965e-179,8.19354243905905e-297,8.18803184223933e-150,5.59199508162208e-185,4.70592047348887e-275,0,0,3.24254633627707e-199,0,0,2.04929816072587e-174,0,1.49761020306716e-292,0,0,7.67924841899316e-198,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.50554049326346e-211,0,0,2.62516476281655e-215,0,0,0,0,0,0,2.07565419998172e-297,0,0,0,4.02462443593887e-303,0,5.38867935014424e-227,1.5970471748543e-188,0,0,0,4.91285762913566e-253,1.42850019399187e-211,0,0,0,4.91569894961307e-218,7.72070847769209e-210,4.18888415875452e-59,0,0,2.17431776021651e-194,0,8.108838441372241e-291,0,0,0,0,2.05654465688355e-224,0,4.30021161884136e-153,0,0,0,0,1.39401929458931e-293,3.40862043143806e-295,0,0,0,0,0,0,1.02049251134904e-242,1.51277077255855e-205,0,0,0,0,1.01667569338007e-294,0,1.06456539058887e-224,6.055151773653439e-216,7.08427810538908e-131,1.79261240819222e-290,3.98846323543092e-107,7.93035347054593e-212,8.504141337963801e-264,4.19557399309118e-144,3.04145474234147e-128,5.10997586596648e-235,3.22825272163771e-205,7.48038289796432e-296,3.67097952346699e-268,0,2.65030611787351e-171,2.15158616444723e-130,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7.06132803913619e-83,2.03580419375504e-80,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6.09805266537051e-195,1.414868372856e-114,1.23778434858872e-239,2.40429330988984e-72,1.91864494229179e-97,2.90982406390999e-181,6.12156160293952e-158,5.014434712343971e-63,1.06425932671559e-57,1.95734289247283e-106,6.69539816224058e-110,1.95916433844387e-169,1.28178704435622e-50,1.47165934340417e-36,3.09724602914701e-109,3.72460339994038e-132,5.01035149610895e-145,5.75121234268653e-178,1.78240317225011e-163,2.44894171464699e-109],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],[\"AA467197\",\"Mmp14\",\"Ccl5\",\"Saa3\",\"Fscn1\",\"Cxcl13\",\"Ms4a4c\",\"Scimp\",\"Fpr2\",\"Gpr84\",\"Bst2\",\"Isg20\",\"Irf7\",\"Il1rn\",\"Dck\",\"Prdx5\",\"Glrx\",\"Isg15\",\"Ccl12\",\"Id2\",\"Chp2\",\"Tmem37\",\"Bmyc\",\"Tmem141\",\"Ypel3\",\"Gpr34\",\"Dbp\",\"Tslp\",\"Tnfrsf17\",\"Ptpn18\",\"Selenbp1\",\"AI467606\",\"Lyl1\",\"Fam89b\",\"Cracr2b\",\"Hfe\",\"Sult1a1\",\"Lamtor4\",\"Pafah1b3\",\"Hpgd\",\"Calhm6\",\"Selp\",\"Ifit1\",\"Il27\",\"Ccl4\",\"Mt1\",\"Il10\",\"Mt2\",\"Ccl3\",\"Cd209a\",\"Csf3\",\"Cmpk2\",\"Rsad2\",\"Hbegf\",\"Ifi47\",\"Sema4c\",\"Cxcl10\",\"Socs1\",\"Tnip3\",\"Timp1\",\"Fap\",\"Mir155hg\",\"Cacna1d\",\"Gvin1\",\"Pde7b\",\"Hdac9\",\"Cdk14\",\"Cers6\",\"Abtb2\",\"Slco3a1\",\"Gm14636\",\"Tmtc2\",\"Aoah\",\"Lpp\",\"Olfr56\",\"Herc6\",\"Gm4070\",\"Alpk1\",\"Ascc3\",\"Myo1e\",\"Nrg2\",\"Bbs9\",\"Aff3\",\"Naaladl2\",\"Nr3c2\",\"Snx29\",\"Prkn\",\"Agmo\",\"Gm10790\",\"Thrb\",\"Mctp1\",\"Gab3\",\"Cables1\",\"Mcc\",\"Rnf150\",\"Tbc1d4\",\"Sema6a\",\"5033421B08Rik\",\"Prkag2\",\"Slc9a9\",\"Glipr1\",\"Cd52\",\"Arl5c\",\"Trpm2\",\"Mmp9\",\"Ccnd1\",\"Ly6a\",\"Limd2\",\"Cxcl13\",\"Lpl\",\"Gpr65\",\"Rrad\",\"Cd55\",\"Basp1\",\"Bcl2a1a\",\"Clec4n\",\"Slamf8\",\"Tmem176a\",\"H2-Q6\",\"Sema4d\",\"Cd19\",\"Mzb1\",\"Iglc1\",\"Ms4a1\",\"Blk\",\"Gimap3\",\"Iglc2\",\"Iglc3\",\"Gm30211\",\"Ly6d\",\"Cd79a\",\"Ikzf3\",\"Pax5\",\"Btla\",\"Mirt1\",\"Igkc\",\"Pou2af1\",\"S100a9\",\"S100a8\",\"Pglyrp1\",\"Lama4\",\"Gpc6\",\"Zfpm2\",\"Thsd7a\",\"Pdgfd\",\"Mfap5\",\"Sulf1\",\"Efemp1\",\"Ackr3\",\"Slit3\",\"Timp3\",\"Prss23\",\"Cdh13\",\"Htra3\",\"Col5a2\",\"Meis2\",\"Sema3c\",\"Adamts5\",\"Fbln2\",\"Plcb4\",\"Ppp1r14c\",\"Sh3bgr\",\"Myoz1\",\"Myl1\",\"Car3\",\"Fitm1\",\"Mettl21c\",\"Tnnt3\",\"Mylpf\",\"Myh1\",\"Ckm\",\"Eef1a2\",\"Tnnc2\",\"Acta1\",\"Ppp1r27\",\"Atp2a1\",\"Eno3\",\"Tmod4\",\"Pgam2\",\"Trim54\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>p_val<\\/th>\\n      <th>avg_log2FC<\\/th>\\n      <th>pct.1<\\/th>\\n      <th>pct.2<\\/th>\\n      <th>p_val_adj<\\/th>\\n      <th>cluster<\\/th>\\n      <th>gene<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"lengthMenu\":[10,25,50,100],\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3,4,5,6]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"p_val\",\"targets\":1},{\"name\":\"avg_log2FC\",\"targets\":2},{\"name\":\"pct.1\",\"targets\":3},{\"name\":\"pct.2\",\"targets\":4},{\"name\":\"p_val_adj\",\"targets\":5},{\"name\":\"cluster\",\"targets\":6},{\"name\":\"gene\",\"targets\":7}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nThese files are also attached in the shared Google folder.\n\n# Selection\n\nIn the meeting on 03.03.25, we decided to go with SCT since it seems that SCTransform better captures the biological variability between different samples/time_points. To be conservative, we will keep resolution at 0.2 which gives us 13 clusters.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n# Validation\n\nTo validate the clusters we will repeat some of our quality control plots separated by cluster. At this stage we just want to check that none of the clusters are obviously the result of technical factors.\n\n::: panel-tabset\n\n## Cluster\n\n::: panel-tabset\n\n### Count\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(seurat_sct@meta.data, aes(x = seurat_clusters, fill = seurat_clusters)) +\n  geom_bar() +\n  labs(title = \"Cluster Counts\", x = \"Cluster\", y = \"Count\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/cluster-count-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n### PCA\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nDimPlot(seurat_sct, reduction = \"pca\", group.by = \"seurat_clusters\") +\n  labs(title = \"PCA by Cluster\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/cluster-pca-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n### UMAP\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nDimPlot(seurat_sct, reduction = \"umap\", group.by = \"seurat_clusters\") +\n  labs(title = \"PCA by Cluster\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/cluster-umap-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n:::\n\n## Sample\n\n::: panel-tabset\n\n### Count\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(seurat_sct@meta.data, aes(x = seurat_clusters, fill = orig.ident)) +\n  scale_fill_manual(values = sample_colors) +\n  geom_bar() +\n  labs(title = \"Sample counts\", x = \"Cluster\", y = \"Count\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/sample-count-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n### Proportion\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(dplyr)\nplot_data <- seurat_sct@meta.data %>%\n  count(seurat_clusters, orig.ident) %>%\n  group_by(seurat_clusters) %>%\n  mutate(prop = n / sum(n))\n\nggplot(plot_data, aes(x = seurat_clusters, y = prop, fill = orig.ident)) +\n  scale_fill_manual(values = sample_colors) +\n  geom_col() +\n  labs(title = \"Proportions by sample\", x = \"Cluster\", y = \"Proportion\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/sample-prop-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n### PCA\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nDimPlot(seurat_sct, reduction = \"pca\", group.by = \"orig.ident\") +\n  scale_color_manual(values = sample_colors) +\n  labs(title = \"PCA by sample\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/sample-pca-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n### umap\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nDimPlot(seurat_sct, reduction = \"umap\", group.by = \"orig.ident\") +\n  scale_color_manual(values = sample_colors) +\n  labs(title = \"umap by sample\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/sample-umap-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n:::\n\n## Selection method\n\n::: panel-tabset\n\n### Count\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(seurat_sct@meta.data, aes(x = seurat_clusters, fill = SelMethod)) +\n  geom_bar() +\n  labs(title = \"\", x = \"Cluster\", y = \"Count\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/sel-count-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n### Proportion\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(dplyr)\nplot_data <- seurat_sct@meta.data %>%\n  count(seurat_clusters, SelMethod) %>%\n  group_by(seurat_clusters) %>%\n  mutate(prop = n / sum(n))\n\nggplot(plot_data, aes(x = seurat_clusters, y = prop, fill = SelMethod)) +\n  geom_col() +\n  labs(title = \"\", x = \"Cluster\", y = \"Proportion\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/sel-prop-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n### PCA\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nDimPlot(seurat_sct, reduction = \"pca\", group.by = \"SelMethod\") +\n  labs(title = \"\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/sel-pca-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n### umap\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nDimPlot(seurat_sct, reduction = \"umap\", group.by = \"SelMethod\") +\n  labs(title = \"\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/sel-umap-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n:::\n\n## nCount_SCT\n\n::: panel-tabset\n\n### Distribution\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(patchwork)\np1 <- VlnPlot(seurat_sct, features = \"nCount_SCT\") + NoLegend()\np2 <- FeaturePlot(seurat_sct, features = \"nCount_SCT\", label = TRUE) + NoLegend()\np1 + p2 + plot_layout(ncol = 2)\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/count-count-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n:::\n\n## nFeature_SCT\n\n::: panel-tabset\n\n### Distribution\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- VlnPlot(seurat_sct, features = \"nFeature_SCT\") + NoLegend()\np2 <- FeaturePlot(seurat_sct, features = \"nFeature_SCT\", label = TRUE) + NoLegend()\np1 + p2 + plot_layout(ncol = 2)\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/feature-count-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n:::\n\n## Percent mito\n\n::: panel-tabset\n\n### Distribution\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- VlnPlot(seurat_sct, features = \"percent.mt\") + NoLegend()\np2 <- FeaturePlot(seurat_sct, features = \"percent.mt\", label = TRUE) + NoLegend()\np1 + p2 + plot_layout(ncol = 2)\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/mt-count-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n:::\n\n## Log 10 genes per UMI\n\n::: panel-tabset\n\n### Distribution\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- VlnPlot(seurat_sct, features = \"log10genes_per_UMI\") + NoLegend()\np2 <- FeaturePlot(seurat_sct, features = \"log10genes_per_UMI\", label = TRUE) + NoLegend()\np1 + p2 + plot_layout(ncol = 2)\n```\n\n::: {.cell-output-display}\n![](03.2_clustering_files/figure-html/genes-count-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n:::\n\n:::\n\n# Summary\n\nAfter clustering, we have a dataset normalized and scaled using SCTransform, and identified 13 clusters.\n\n## Parameters\n\nThis table describes parameters used and set in this document.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(DT)\nres <- 0.2\nresolutions <- seq(0, 1, 0.1)\n\nparams <- list(\n  list(\n    Parameter = \"Number of genes selected by the VST method\",\n    Value = \"3000\"\n  ),\n  list(\n    Parameter = \"Number of genes selected by the SCT method\",\n    Value = \"3000\"\n  ),\n  list(\n    Parameter = \"Number of principal components for VST object clustering\",\n    Value = 18\n  ),\n  list(\n    Parameter = \"Number of principal components for SCT object clustering\",\n    Value = 13\n  ),\n  list(\n    Parameter = \"Number of neighbours for nearest neighbor graph\",\n    Value = 30\n  ),\n  list(\n    Parameter = \"Range of possible clustering resolutions\",\n    Value = \"0-0.9\"\n  ),\n  list(\n    Parameter = \"Method chosen for downstream analysis\",\n    Value = \"SCTransform\"\n  ),\n  list(\n    Parameter = \"Selected resolution parameter for clustering\",\n    Value = res\n  ),\n  list(\n    Parameter = \"Number of clusters produced by selected resolution\",\n    Value = \"13\"\n  )\n)\n\n# Convert each sublist to a data frame and bind them together\nparams_df <- do.call(rbind, lapply(params, function(x) {\n  data.frame(Parameter = x$Parameter, Value = x$Value, stringsAsFactors = FALSE)\n}))\n\ndatatable(\n  params_df,\n  options = list(pageLength = 10),\n  rownames = TRUE,\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-8a29e7a6c62ff9e80bdd\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8a29e7a6c62ff9e80bdd\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\"],[\"Number of genes selected by the VST method\",\"Number of genes selected by the SCT method\",\"Number of principal components for VST object clustering\",\"Number of principal components for SCT object clustering\",\"Number of neighbours for nearest neighbor graph\",\"Range of possible clustering resolutions\",\"Method chosen for downstream analysis\",\"Selected resolution parameter for clustering\",\"Number of clusters produced by selected resolution\"],[\"3000\",\"3000\",\"18\",\"13\",\"30\",\"0-0.9\",\"SCTransform\",\"0.2\",\"13\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Parameter<\\/th>\\n      <th>Value<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"columnDefs\":[{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Parameter\",\"targets\":1},{\"name\":\"Value\",\"targets\":2}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n```{.r .cell-code}\n#write.csv(params_df, file=\"./output/data/03.2_clustering/03.2_SI_clustering_summary.csv\", row.names = FALSE)\n```\n:::\n\n\n\n## Output files\n\nThis table describes the output files produced by this document.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaved_files <- extract_saved_files(\"./analysis/03.2_clustering.qmd\")\nprint(saved_files)\nwrite.csv(saved_files, file = paste0(proj_dir, \"/output/data/03.2_clustering/03.2_SI_saved_files_summary.csv\"))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsaved_files <- read.csv(file = paste0(proj_dir, \"/output/data/03.2_clustering/03.2_SI_saved_files_summary.csv\"))\nparams <- jsonlite::toJSON(saved_files, pretty = TRUE)\nknitr::kable(jsonlite::fromJSON(params))\n```\n\n::: {.cell-output-display}\n\n\n|  X|File                               |Directory                                       |Description                                          |\n|--:|:----------------------------------|:-----------------------------------------------|:----------------------------------------------------|\n|  1|seurat_sct                         |file=./output/processed/03.2_SI_seurat_sct.Robj |full SCT seurat obj                                  |\n|  2|pvm_sct, file=paste0(sobj_dir,tag  |_pvm_sct.Robj)                                  |PVM subsetted obj, SCTransformed                     |\n|  3|pvm_vst, file=paste0(sobj_dir,tag  |_pvm_vst.Robj)                                  |PVM subsetted obj, VST for normalization and scaling |\n|  4|seurat_sct, file = paste0(sobj_dir |03.2_SI_clean_sobj.Robj)                        |full SCT seurat obj, RNA layer normalized and scaled |\n\n\n:::\n:::\n\n\n\n# Session information\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndevtools::session_info()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.3.3 (2024-02-29)\n os       macOS Sonoma 14.6.1\n system   x86_64, darwin20\n ui       X11\n language (EN)\n collate  en_US.UTF-8\n ctype    en_US.UTF-8\n tz       Europe/Vienna\n date     2025-03-04\n pandoc   3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n ! package              * version    date (UTC) lib source\n P abind                  1.4-8      2024-09-12 [?] CRAN (R 4.3.3)\n   beeswarm               0.4.0      2021-06-01 [1] RSPM (R 4.3.0)\n   Biobase              * 2.62.0     2023-10-24 [1] Bioconductor\n   BiocGenerics         * 0.48.1     2023-11-01 [1] Bioconductor\n P BiocManager            1.30.25    2024-08-28 [?] CRAN (R 4.3.3)\n P bitops                 1.0-9      2024-10-03 [?] CRAN (R 4.3.3)\n   bslib                  0.8.0      2024-07-29 [1] RSPM (R 4.3.0)\n P cachem                 1.1.0      2024-05-16 [?] CRAN (R 4.3.3)\n   cli                    3.6.3      2024-06-21 [1] RSPM (R 4.3.0)\n P cluster                2.1.6      2023-12-01 [?] CRAN (R 4.3.3)\n P clustree             * 0.5.1      2023-11-05 [?] CRAN (R 4.3.0)\n P codetools              0.2-19     2023-02-01 [?] CRAN (R 4.3.3)\n P colorspace             2.1-1      2024-07-26 [?] CRAN (R 4.3.3)\n P cowplot              * 1.1.3      2024-01-22 [?] CRAN (R 4.3.2)\n P crayon                 1.5.3      2024-06-20 [?] CRAN (R 4.3.3)\n P crosstalk              1.2.1      2023-11-23 [?] CRAN (R 4.3.0)\n P data.table             1.16.4     2024-12-06 [?] RSPM\n   DelayedArray           0.28.0     2023-10-24 [1] Bioconductor\n P deldir                 2.0-4      2024-02-28 [?] CRAN (R 4.3.2)\n P devtools               2.4.5      2022-10-11 [?] CRAN (R 4.3.0)\n   digest                 0.6.37     2024-08-19 [1] RSPM (R 4.3.0)\n P dotCall64              1.2        2024-10-04 [?] CRAN (R 4.3.3)\n P dplyr                * 1.1.4      2023-11-17 [?] CRAN (R 4.3.0)\n P DT                   * 0.33       2024-04-04 [?] CRAN (R 4.3.2)\n P ellipsis               0.3.2      2021-04-29 [?] CRAN (R 4.3.0)\n   evaluate               1.0.1      2024-10-10 [1] RSPM (R 4.3.0)\n P farver                 2.1.2      2024-05-13 [?] CRAN (R 4.3.3)\n P fastDummies            1.7.4      2024-08-16 [?] RSPM\n P fastmap                1.2.0      2024-05-15 [?] CRAN (R 4.3.3)\n P fitdistrplus           1.2-1      2024-07-12 [?] CRAN (R 4.3.3)\n P forcats              * 1.0.0      2023-01-29 [?] RSPM\n   fs                     1.6.5      2024-10-30 [1] RSPM (R 4.3.0)\n P future                 1.34.0     2024-07-29 [?] CRAN (R 4.3.3)\n P future.apply           1.11.3     2024-10-27 [?] CRAN (R 4.3.3)\n P generics               0.1.3      2022-07-05 [?] CRAN (R 4.3.0)\n   GenomeInfoDb         * 1.38.8     2024-03-15 [1] Bioconductor 3.18 (R 4.3.3)\n   GenomeInfoDbData       1.2.11     2024-12-25 [1] Bioconductor\n   GenomicRanges        * 1.54.1     2023-10-29 [1] Bioconductor\n   ggbeeswarm             0.7.2      2023-04-29 [1] RSPM (R 4.3.0)\n P ggforce              * 0.4.2      2024-02-19 [?] CRAN (R 4.3.2)\n P ggplot2              * 3.5.1      2024-04-23 [?] CRAN (R 4.3.2)\n P ggraph               * 2.2.1      2024-03-07 [?] CRAN (R 4.3.2)\n   ggrastr                1.0.2      2023-06-01 [1] RSPM (R 4.3.3)\n P ggrepel              * 0.9.6      2024-09-07 [?] CRAN (R 4.3.3)\n P ggridges               0.5.6      2024-01-23 [?] CRAN (R 4.3.2)\n P globals                0.16.3     2024-03-08 [?] CRAN (R 4.3.2)\n   glue                   1.8.0      2024-09-30 [1] RSPM (R 4.3.0)\n P goftest                1.2-3      2021-10-07 [?] CRAN (R 4.3.0)\n P graphlayouts           1.2.1      2024-11-18 [?] CRAN (R 4.3.3)\n P gridExtra              2.3        2017-09-09 [?] CRAN (R 4.3.0)\n P gtable                 0.3.6      2024-10-25 [?] CRAN (R 4.3.3)\n P hms                    1.1.3      2023-03-21 [?] CRAN (R 4.3.0)\n P htmltools              0.5.8.1    2024-04-04 [?] CRAN (R 4.3.2)\n P htmlwidgets            1.6.4      2023-12-06 [?] CRAN (R 4.3.0)\n P httpuv                 1.6.15     2024-03-26 [?] CRAN (R 4.3.2)\n P httr                   1.4.7      2023-08-15 [?] CRAN (R 4.3.0)\n P ica                    1.0-3      2022-07-08 [?] CRAN (R 4.3.0)\n P igraph                 2.1.2      2024-12-07 [?] RSPM\n   IRanges              * 2.36.0     2023-10-24 [1] Bioconductor\n P irlba                  2.3.5.1    2022-10-03 [?] CRAN (R 4.3.0)\n P jquerylib              0.1.4      2021-04-26 [?] CRAN (R 4.3.0)\n   jsonlite               1.8.9      2024-09-20 [1] RSPM (R 4.3.0)\n P KernSmooth             2.23-24    2024-05-17 [?] CRAN (R 4.3.3)\n   knitr                * 1.49       2024-11-08 [1] RSPM (R 4.3.0)\n P labeling               0.4.3      2023-08-29 [?] CRAN (R 4.3.0)\n P later                  1.4.1      2024-11-27 [?] RSPM\n P lattice                0.22-5     2023-10-24 [?] CRAN (R 4.3.3)\n P lazyeval               0.2.2      2019-03-15 [?] CRAN (R 4.3.0)\n P leiden                 0.4.3.1    2023-11-17 [?] CRAN (R 4.3.0)\n P lifecycle              1.0.4      2023-11-07 [?] CRAN (R 4.3.0)\n P listenv                0.9.1      2024-01-29 [?] CRAN (R 4.3.2)\n P lmtest                 0.9-40     2022-03-21 [?] CRAN (R 4.3.0)\n P lubridate            * 1.9.4      2024-12-08 [?] RSPM\n   magrittr               2.0.3      2022-03-30 [1] RSPM (R 4.3.0)\n P MASS                   7.3-60.0.1 2024-01-13 [?] CRAN (R 4.3.3)\n P Matrix                 1.6-5      2024-01-11 [?] CRAN (R 4.3.3)\n   MatrixGenerics       * 1.14.0     2023-10-24 [1] Bioconductor\n P matrixStats          * 1.4.1      2024-09-08 [?] CRAN (R 4.3.3)\n P memoise                2.0.1      2021-11-26 [?] CRAN (R 4.3.0)\n P mime                   0.12       2021-09-28 [?] CRAN (R 4.3.0)\n P miniUI                 0.1.1.1    2018-05-18 [?] CRAN (R 4.3.0)\n P munsell                0.5.1      2024-04-01 [?] CRAN (R 4.3.2)\n P nlme                   3.1-164    2023-11-27 [?] CRAN (R 4.3.3)\n P parallelly             1.41.0     2024-12-18 [?] RSPM\n P patchwork            * 1.3.0      2024-09-16 [?] CRAN (R 4.3.3)\n P pbapply                1.7-2      2023-06-27 [?] CRAN (R 4.3.0)\n P pillar                 1.10.0     2024-12-17 [?] RSPM\n P pkgbuild               1.4.5      2024-10-28 [?] CRAN (R 4.3.3)\n P pkgconfig              2.0.3      2019-09-22 [?] CRAN (R 4.3.0)\n P pkgload                1.4.0      2024-06-28 [?] RSPM\n P plotly                 4.10.4     2024-01-13 [?] CRAN (R 4.3.0)\n P plyr                   1.8.9      2023-10-02 [?] CRAN (R 4.3.0)\n P png                    0.1-8      2022-11-29 [?] CRAN (R 4.3.0)\n P polyclip               1.10-7     2024-07-23 [?] RSPM\n P profvis                0.4.0      2024-09-20 [?] CRAN (R 4.3.3)\n P progressr              0.15.1     2024-11-22 [?] RSPM\n P promises               1.3.2      2024-11-28 [?] RSPM\n P purrr                * 1.0.2      2023-08-10 [?] CRAN (R 4.3.0)\n P R6                     2.5.1      2021-08-19 [?] CRAN (R 4.3.0)\n P RANN                   2.6.2      2024-08-25 [?] RSPM\n P RColorBrewer           1.1-3      2022-04-03 [?] CRAN (R 4.3.0)\n P Rcpp                   1.0.13-1   2024-11-02 [?] CRAN (R 4.3.3)\n P RcppAnnoy              0.0.22     2024-01-23 [?] CRAN (R 4.3.2)\n P RcppHNSW               0.6.0      2024-02-04 [?] CRAN (R 4.3.2)\n   RCurl                  1.98-1.16  2024-07-11 [1] RSPM (R 4.3.0)\n P readr                * 2.1.5      2024-01-10 [?] RSPM\n P remotes                2.5.0      2024-03-17 [?] RSPM\n   renv                   1.0.11     2024-10-12 [1] RSPM (R 4.3.0)\n P reshape2               1.4.4      2020-04-09 [?] CRAN (R 4.3.0)\n P reticulate             1.40.0     2024-11-15 [?] CRAN (R 4.3.3)\n   rlang                  1.1.4      2024-06-04 [1] RSPM (R 4.3.0)\n   rmarkdown              2.29       2024-11-04 [1] RSPM (R 4.3.0)\n P ROCR                   1.0-11     2020-05-02 [?] CRAN (R 4.3.0)\n P RSpectra               0.16-2     2024-07-18 [?] RSPM\n P rstudioapi             0.17.1     2024-10-22 [?] CRAN (R 4.3.3)\n P Rtsne                  0.17       2023-12-07 [?] CRAN (R 4.3.0)\n   S4Arrays               1.2.1      2024-03-06 [1] Bioconductor 3.18 (R 4.3.3)\n   S4Vectors            * 0.40.2     2023-11-23 [1] Bioconductor\n P sass                   0.4.9      2024-03-15 [?] CRAN (R 4.3.2)\n P scales                 1.3.0      2023-11-28 [?] CRAN (R 4.3.0)\n P scattermore            1.2        2023-06-12 [?] CRAN (R 4.3.0)\n P sctransform            0.4.1      2023-10-19 [?] CRAN (R 4.3.0)\n P sessioninfo            1.2.2      2021-12-06 [?] CRAN (R 4.3.0)\n P Seurat               * 5.1.0      2024-05-10 [?] CRAN (R 4.3.3)\n P SeuratObject         * 5.0.2      2024-05-08 [?] CRAN (R 4.3.2)\n P shiny                  1.10.0     2024-12-14 [?] RSPM\n   SingleCellExperiment * 1.24.0     2023-10-24 [1] Bioconductor\n P sp                   * 2.1-4      2024-04-30 [?] CRAN (R 4.3.3)\n P spam                   2.11-0     2024-10-03 [?] CRAN (R 4.3.3)\n   SparseArray            1.2.4      2024-02-11 [1] Bioconductor 3.18 (R 4.3.2)\n P spatstat.data          3.1-4      2024-11-15 [?] CRAN (R 4.3.3)\n P spatstat.explore       3.3-3      2024-10-22 [?] CRAN (R 4.3.3)\n P spatstat.geom          3.3-4      2024-11-18 [?] RSPM\n P spatstat.random        3.3-2      2024-09-18 [?] CRAN (R 4.3.3)\n P spatstat.sparse        3.1-0      2024-06-21 [?] RSPM\n P spatstat.univar        3.1-1      2024-11-05 [?] CRAN (R 4.3.3)\n P spatstat.utils         3.1-1      2024-11-03 [?] CRAN (R 4.3.3)\n P stringi                1.8.4      2024-05-06 [?] CRAN (R 4.3.2)\n   stringr              * 1.5.1      2023-11-14 [1] RSPM (R 4.3.0)\n   SummarizedExperiment * 1.32.0     2023-10-24 [1] Bioconductor\n P survival               3.5-8      2024-02-14 [?] CRAN (R 4.3.3)\n P tensor                 1.5        2012-05-05 [?] CRAN (R 4.3.0)\n P tibble               * 3.2.1      2023-03-20 [?] CRAN (R 4.3.0)\n P tidygraph              1.3.1      2024-01-30 [?] CRAN (R 4.3.2)\n P tidyr                * 1.3.1      2024-01-24 [?] CRAN (R 4.3.2)\n P tidyselect             1.2.1      2024-03-11 [?] CRAN (R 4.3.2)\n P tidyverse            * 2.0.0      2023-02-22 [?] CRAN (R 4.3.0)\n P timechange             0.3.0      2024-01-18 [?] CRAN (R 4.3.0)\n P tweenr                 2.0.3      2024-02-26 [?] CRAN (R 4.3.2)\n P tzdb                   0.4.0      2023-05-12 [?] CRAN (R 4.3.0)\n P urlchecker             1.0.1      2021-11-30 [?] CRAN (R 4.3.0)\n P usethis                3.1.0      2024-11-26 [?] CRAN (R 4.3.3)\n P uwot                   0.2.2      2024-04-21 [?] RSPM\n P vctrs                  0.6.5      2023-12-01 [?] CRAN (R 4.3.0)\n   vipor                  0.4.7      2023-12-18 [1] RSPM (R 4.3.0)\n P viridis              * 0.6.5      2024-01-29 [?] CRAN (R 4.3.2)\n P viridisLite          * 0.4.2      2023-05-02 [?] CRAN (R 4.3.0)\n P withr                  3.0.2      2024-10-28 [?] CRAN (R 4.3.3)\n   xfun                   0.49       2024-10-31 [1] RSPM (R 4.3.0)\n P xtable                 1.8-4      2019-04-21 [?] CRAN (R 4.3.0)\n   XVector                0.42.0     2023-10-24 [1] Bioconductor\n   yaml                   2.3.10     2024-07-26 [1] RSPM (R 4.3.0)\n   zlibbioc               1.48.2     2024-03-13 [1] Bioconductor 3.18 (R 4.3.3)\n P zoo                    1.8-12     2023-04-13 [?] CRAN (R 4.3.0)\n\n [1] /Users/nami/Desktop/sterile_inflammation/renv/library/R-4.3/x86_64-apple-darwin20\n [2] /Users/nami/Library/Caches/org.R-project.R/R/renv/sandbox/R-4.3/x86_64-apple-darwin20/b06620f4\n\n P ── Loaded and on-disk path mismatch.\n\n──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n",
    "supporting": [
      "03.2_clustering_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}